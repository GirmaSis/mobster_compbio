init = 'peaks',
tail = c(TRUE, FALSE),
is_verbose = F,
fit.type = 'MM',
maxIter = 2000,
epsilon = 1e-4,
samples = 10,
parallel = TRUE,
top = 100,
file.dump = names(timon)[id]
)
getwd()
names(timon)[id]
id
names(timon)
id
x = dbpmm.fit(
X = X,
K = 1:5,
init = 'peaks',
tail = c(TRUE, FALSE),
is_verbose = F,
fit.type = 'MM',
maxIter = 2000,
epsilon = 1e-4,
samples = 10,
parallel = TRUE,
top = 100,
file.dump = id
)
plot(x[[1]])
load('3e767bee290c03b408abc737570a6d36-allRuns.RData')
res$tests
x = res$tests
x$K = as.factor(x$K)
x$tail = as.factor(x$tail)
x
pa = ggplot(data = results, aes(x = K, y = ICL, fill = tail)) +
geom_boxplot(alpha = alpha) +
# scale_fill_manual(values = col.histogram) +
guides(fill=FALSE) +
labs(title  = bquote('Parameters: '~ mu[i] ~ '/' ~sigma[i])) +
xlab('') + ylab(bquote(italic('sampled'))) +
theme_light()
require(ggplot2)
pa = ggplot(data = results, aes(x = K, y = ICL, fill = tail)) +
geom_boxplot(alpha = alpha) +
# scale_fill_manual(values = col.histogram) +
guides(fill=FALSE) +
labs(title  = bquote('Parameters: '~ mu[i] ~ '/' ~sigma[i])) +
xlab('') + ylab(bquote(italic('sampled'))) +
theme_light()
pa = ggplot(data = x, aes(x = K, y = ICL, fill = tail)) +
geom_boxplot(alpha = alpha) +
# scale_fill_manual(values = col.histogram) +
guides(fill=FALSE) +
labs(title  = bquote('Parameters: '~ mu[i] ~ '/' ~sigma[i])) +
xlab('') + ylab(bquote(italic('sampled'))) +
theme_light()
pa
pa = ggplot(data = x, aes(x = K, y = ICL, fill = tail)) +
geom_boxplot(alpha = alpha) +
# scale_fill_manual(values = col.histogram) +
guides(fill=FALSE) +
labs(title  = bquote('Parameters:') +
xlab('') + ylab(bquote(italic('sampled'))) +
theme_light()
pa
}
pa = ggplot(data = x, aes(x = K, y = ICL, fill = tail)) +
geom_boxplot(alpha = alpha) +
# scale_fill_manual(values = col.histogram) +
guides(fill=FALSE) +
labs(title  = bquote('Parameters:')) +
xlab('') + ylab(bquote(italic('sampled'))) +
theme_light()
pa
alpha = .5
pa = ggplot(data = x, aes(x = K, y = ICL, fill = tail)) +
geom_boxplot(alpha = alpha) +
# scale_fill_manual(values = col.histogram) +
guides(fill=FALSE) +
labs(title  = bquote('Parameters:')) +
xlab('') + ylab(bquote(italic('sampled'))) +
theme_light()
pa
pa = ggplot(data = x, aes(x = K, y = ICL, fill = tail)) +
geom_boxplot(alpha = alpha) +
# scale_fill_manual(values = col.histogram) +
# guides(fill=FALSE) +
labs(title  = bquote('Parameters:')) +
xlab('') + ylab(bquote(italic('sampled'))) +
theme_light()
pa
pa = ggplot(data = x, aes(x = tail, y = ICL, fill = K)) +
geom_boxplot(alpha = alpha) +
# scale_fill_manual(values = col.histogram) +
# guides(fill=FALSE) +
labs(title  = bquote('Parameters:')) +
xlab('') + ylab(bquote(italic('ICL'))) +
theme_light()
pa
pa = ggplot(data = x, aes(x = tail, y = ICL, fill = K)) +
geom_boxplot(alpha = alpha) +
# scale_fill_manual(values = col.histogram) +
# guides(fill=FALSE) +
labs(title  = bquote('Parameters:')) +
xlab('') + ylab(bquote(italic('ICL'))) +
theme_light()
pa = ggplot(data = x, aes(x = tail, y = ICL, fill = K)) +
geom_boxplot(alpha = alpha) +
scale_y_log10() +
# scale_fill_manual(values = col.histogram) +
# guides(fill=FALSE) +
labs(title  = bquote('Parameters:')) +
xlab('') + ylab(bquote(italic('ICL'))) +
theme_light()
pa
pa = ggplot(data = x, aes(x = tail, y = ICL, fill = K)) +
geom_boxplot(alpha = alpha) +
# scale_y_log10() +
# scale_fill_manual(values = col.histogram) +
# guides(fill=FALSE) +
labs(title  = bquote('Parameters:')) +
xlab('') + ylab(bquote(italic('ICL'))) +
theme_light()
pa
x$ICL
hist(x$ICL)
x
pa
pa = ggplot(data = x, aes(x = tail, y = ICL, fill = K)) +
geom_boxplot(alpha = alpha) +
# scale_y_log10() +
# scale_fill_manual(values = col.histogram) +
# guides(fill=FALSE) +
labs(title  = bquote('Parameters:')) +
xlab('') + ylab(bquote(italic('ICL'))) +
theme_light() + facet_wrap(K)
pa = ggplot(data = x, aes(x = tail, y = ICL, fill = K)) +
geom_boxplot(alpha = alpha) +
# scale_y_log10() +
# scale_fill_manual(values = col.histogram) +
# guides(fill=FALSE) +
labs(title  = bquote('Parameters:')) +
xlab('') + ylab(bquote(italic('ICL'))) +
theme_light() + facet_wrap(~K)
pa
pa = ggplot(data = x, aes(x = tail, y = ICL, fill = K)) +
geom_boxplot(alpha = alpha) +
# scale_y_log10() +
# scale_fill_manual(values = col.histogram) +
# guides(fill=FALSE) +
labs(title  = bquote('Parameters:')) +
xlab('') + ylab(bquote(italic('ICL'))) +
theme_light() + facet_wrap(~K, nrow = 1)
pa
pa = ggplot(data = x, aes(x = tail, y = ICL, fill = K)) +
geom_boxplot(alpha = alpha) +
# scale_y_log10() +
# scale_fill_manual(values = col.histogram) +
# guides(fill=FALSE) +
labs(title  = bquote('ICL Score, '~ .(nrow(x)) ~' runs')) +
xlab('') + ylab(bquote(italic('ICL'))) +
theme_light() + facet_wrap(~K, nrow = 1)
pa
pa = ggplot(data = x, aes(x = tail, y = ICL, fill = K)) +
geom_boxplot(alpha = alpha) +
# scale_y_log10() +
# scale_fill_manual(values = col.histogram) +
# guides(fill=FALSE) +
labs(title  = bquote(bold('ICL Score: ')~ .(nrow(x)) ~' runs')) +
xlab('') + ylab(bquote(italic('ICL'))) +
theme_light() + facet_wrap(~K, nrow = 1)
pa
pa = ggplot(data = x, aes(x = tail, y = ICL, fill = K)) +
geom_boxplot(alpha = alpha) +
# scale_y_log10() +
# scale_fill_manual(values = col.histogram) +
# guides(fill=FALSE) +
labs(title  = bquote(bold('ICL Score: ')~ .(nrow(x)) ~' runs')) +
xlab('') + ylab(bquote(italic('ICL'))) +
theme_light() +
facet_wrap(~K, nrow = 1) +
geom_jitter(width = 0.2)
pa
pa = ggplot(data = x, aes(x = tail, y = ICL, fill = K)) +
# geom_boxplot(alpha = alpha) +
# scale_y_log10() +
# scale_fill_manual(values = col.histogram) +
# guides(fill=FALSE) +
labs(title  = bquote(bold('ICL Score: ')~ .(nrow(x)) ~' runs')) +
xlab('') + ylab(bquote(italic('ICL'))) +
theme_light() +
facet_wrap(~K, nrow = 1) +
geom_jitter(width = 0.2, )
pa
pa = ggplot(data = x, aes(x = tail, y = ICL, fill = K)) +
# geom_boxplot(alpha = alpha) +
# scale_y_log10() +
# scale_fill_manual(values = col.histogram) +
# guides(fill=FALSE) +
labs(title  = bquote(bold('ICL Score: ')~ .(nrow(x)) ~' runs')) +
xlab('') + ylab(bquote(italic('ICL'))) +
theme_light() +
facet_wrap(~K, nrow = 1) +
geom_jitter(width = 0.2, colour = 'red')
pa
pa = ggplot(data = x, aes(x = tail, y = ICL, fill = K)) +
# geom_boxplot(alpha = alpha) +
# scale_y_log10() +
# scale_fill_manual(values = col.histogram) +
# guides(fill=FALSE) +
labs(title  = bquote(bold('ICL Score: ')~ .(nrow(x)) ~' runs')) +
xlab('') + ylab(bquote(italic('ICL'))) +
theme_light() +
facet_wrap(~K, nrow = 1) +
geom_jitter(width = 1, colour = 'red')
pa
pa = ggplot(data = x, aes(x = tail, y = ICL, fill = K)) +
# geom_boxplot(alpha = alpha) +
# scale_y_log10() +
# scale_fill_manual(values = col.histogram) +
# guides(fill=FALSE) +
labs(title  = bquote(bold('ICL Score: ')~ .(nrow(x)) ~' runs')) +
xlab('') + ylab(bquote(italic('ICL'))) +
theme_light() +
facet_wrap(~K, nrow = 1) +
geom_jitter(width = .7, colour = 'red')
pa
pa = ggplot(data = x, aes(x = tail, y = ICL, fill = K)) +
geom_boxplot(alpha = alpha) +
# scale_y_log10() +
# scale_fill_manual(values = col.histogram) +
# guides(fill=FALSE) +
labs(title  = bquote(bold('ICL Score: ')~ .(nrow(x)) ~' runs')) +
xlab('') + ylab(bquote(italic('ICL'))) +
theme_light() +
facet_wrap(~K, nrow = 1) +
geom_jitter(width = .7, colour = 'red')
pa
pa = ggplot(data = x, aes(x = tail, y = ICL, fill = K)) +
geom_boxplot(alpha = alpha) +
# scale_y_log10() +
# scale_fill_manual(values = col.histogram) +
# guides(fill=FALSE) +
labs(title  = bquote(bold('ICL Score: ')~ .(nrow(x)) ~' runs')) +
xlab('') + ylab(bquote(italic('ICL'))) +
theme_light() +
facet_wrap(~K, nrow = 1)
pa
pa = ggplot(data = x, aes(x = tail, y = ICL, fill = K)) +
geom_boxplot(alpha = alpha) +
# scale_y_log10() +
scale_fill_brewer('Accent') +
# scale_fill_manual(values = col.histogram) +
# guides(fill=FALSE) +
labs(title  = bquote(bold('ICL Score: ')~ .(nrow(x)) ~' runs')) +
xlab('') + ylab(bquote(italic('ICL'))) +
theme_light() +
facet_wrap(~K, nrow = 1)
pa
pa = ggplot(data = x, aes(x = tail, y = ICL, fill = K)) +
geom_boxplot(alpha = alpha) +
# scale_y_log10() +
scale_fill_brewer('Set1') +
# scale_fill_manual(values = col.histogram) +
# guides(fill=FALSE) +
labs(title  = bquote(bold('ICL Score: ')~ .(nrow(x)) ~' runs')) +
xlab('') + ylab(bquote(italic('ICL'))) +
theme_light() +
facet_wrap(~K, nrow = 1)
pa
pa = ggplot(data = x, aes(x = tail, y = ICL, fill = K)) +
geom_boxplot(alpha = alpha) +
# scale_y_log10() +
scale_fill_brewer(palette = 'Set1') +
# scale_fill_manual(values = col.histogram) +
# guides(fill=FALSE) +
labs(title  = bquote(bold('ICL Score: ')~ .(nrow(x)) ~' runs')) +
xlab('') + ylab(bquote(italic('ICL'))) +
theme_light() +
facet_wrap(~K, nrow = 1)
pa
min(x$ICL)
which.min(x$ICL)
pa = ggplot(data = x, aes(x = K, y = ICL, fill = tail)) +
geom_boxplot(alpha = alpha) +
# scale_y_log10() +
scale_fill_brewer(palette = 'Set1') +
# scale_fill_manual(values = col.histogram) +
# guides(fill=FALSE) +
labs(title  = bquote(bold('ICL Score: ')~ .(nrow(x)) ~' runs')) +
xlab('') + ylab(bquote(italic('ICL'))) +
theme_light() +
facet_wrap(~K, nrow = 1) +
geom_point(data =
x[x$ICL > plot_Data$upper.limit | plot_Data$mpg < plot_Data$lower.limit,],
aes(x=factor(cyl),
y=mpg, col=factor(cyl)))
pa = ggplot(data = x, aes(x = K, y = ICL, fill = tail)) +
geom_boxplot(alpha = alpha) +
scale_fill_brewer(palette = 'Set1') +
labs(title  = bquote(bold('ICL Score: ')~ .(nrow(x)) ~' runs')) +
xlab('') + ylab(bquote(italic('ICL'))) +
theme_light() +
facet_wrap(~K, nrow = 1)
pa
pa = ggplot(data = x, aes(x = K, y = ICL, fill = tail)) +
geom_boxplot(alpha = alpha) +
scale_fill_brewer(palette = 'Set1') +
labs(title  = bquote(bold('ICL Score: ')~ .(nrow(x)) ~' runs')) +
xlab('') + ylab(bquote(italic('ICL'))) +
theme_light() +
facet_wrap(~tail, nrow = 1)
pa
pa = ggplot(data = x, aes(x = K, y = ICL, fill = K)) +
geom_boxplot(alpha = alpha) +
scale_fill_brewer(palette = 'Set1') +
labs(title  = bquote(bold('ICL Score: ')~ .(nrow(x)) ~' runs')) +
xlab('K') + ylab(bquote(italic('ICL'))) +
theme_light() +
facet_wrap(~tail, nrow = 1)
pa
levels(x$tail)
load('3e767bee290c03b408abc737570a6d36-allRuns.RData')
x = res$tests
x$tail[x$tail] = 'With Tail'
x
x$tail[x$tail == 'FALSE'] = 'Without Tail'
x$K = as.factor(x$K)
x$tail = as.factor(x$tail)
levels(x$tail) <- c("S", "Ve", "Vi")
pa = ggplot(data = x, aes(x = K, y = ICL, fill = K)) +
geom_boxplot(alpha = alpha) +
scale_fill_brewer(palette = 'Set1') +
labs(title  = bquote(bold('ICL Score: ')~ .(nrow(x)) ~' runs')) +
xlab('K') + ylab(bquote(italic('ICL'))) +
theme_light() +
facet_wrap(~tail, nrow = 1)
pa
load('3e767bee290c03b408abc737570a6d36-allRuns.RData')
x = res$tests
x$tail[x$tail] = 'With Tail'
x$tail[x$tail == 'FALSE'] = 'Without Tail'
x$K = as.factor(x$K)
x$tail = as.factor(x$tail)
pa = ggplot(data = x, aes(x = K, y = ICL, fill = K)) +
geom_boxplot(alpha = alpha) +
scale_fill_brewer(palette = 'Set1') +
labs(title  = bquote(bold('ICL Score: ')~ .(nrow(x)) ~' runs')) +
xlab('K') + ylab(bquote(italic('ICL'))) +
theme_light() +
facet_wrap(~tail, nrow = 1)
pa
x
y = split(x, f = x$K)
y
library(dbpmm)
x = dbpmm.fit(
X = X,
K = 1:5,
init = 'peaks',
tail = c(TRUE, FALSE),
is_verbose = F,
fit.type = 'MM',
maxIter = 2000,
epsilon = 1e-4,
samples = 3,
parallel = TRUE,
top = 100,
file.dump = id
)
library(dbpmm)
x = dbpmm.fit(
X = X,
K = 1:5,
init = 'peaks',
tail = c(TRUE, FALSE),
is_verbose = F,
fit.type = 'MM',
maxIter = 2000,
epsilon = 1e-4,
samples = 3,
parallel = TRUE,
top = 100,
file.dump = id
)
library(dbpmm)
library(dbpmm)
x = dbpmm.fit(
X = X,
K = 1:5,
init = 'peaks',
tail = c(TRUE, FALSE),
is_verbose = F,
fit.type = 'MM',
maxIter = 2000,
epsilon = 1e-4,
samples = 3,
parallel = TRUE,
top = 100,
file.dump = id
)
library(dbpmm)
x = dbpmm.fit(
X = X,
K = 1:5,
init = 'peaks',
tail = c(TRUE, FALSE),
is_verbose = F,
fit.type = 'MM',
maxIter = 2000,
epsilon = 1e-4,
samples = 3,
parallel = TRUE,
top = 100,
file.dump = id
)
getwd()
library(dbpmm)
id = '3e767bee290c03b408abc737570a6d36'
id = 3
timon[[id]]
id = 4
timon[[id]]
X = timon[[id]]$data$alt/timon[[id]]$data$depth
x = dbpmm.fit(
X = X,
K = 1:5,
init = 'peaks',
tail = c(TRUE, FALSE),
is_verbose = F,
fit.type = 'MM',
maxIter = 2000,
epsilon = 1e-4,
samples = 3,
parallel = TRUE,
top = 100,
file.dump = id
)
id = names(timon)[[4]]
x = dbpmm.fit(
X = X,
K = 1:5,
init = 'peaks',
tail = c(TRUE, FALSE),
is_verbose = F,
fit.type = 'MM',
maxIter = 2000,
epsilon = 1e-4,
samples = 3,
parallel = TRUE,
top = 100,
file.dump = id
)
x = dbpmm.fit(
X = X,
K = 1:5,
init = 'peaks',
tail = c(TRUE, FALSE),
is_verbose = F,
fit.type = 'MM',
maxIter = 2000,
epsilon = 1e-4,
samples = 3,
parallel = TRUE,
top = 100,
file.dump = id,
annotation = 'Popgen tumour by Timon'
)
load('1a4231de31794801d9b3911c79352830-allRuns.RData')
x = res$tests
x
3x
x
complete.cases(x)
x[complete.cases(x), ]
.plot.fit.summary = function(x, alpha = .5) {
x = x[complete.cases(x), ]
x$tail[x$tail] = 'With Tail'
x$tail[x$tail == 'FALSE'] = 'Without Tail'
x$K = as.factor(x$K)
x$tail = as.factor(x$tail)
pa = ggplot(data = x, aes(x = K, y = ICL, fill = K)) +
geom_boxplot(alpha = alpha) +
scale_fill_brewer(palette = 'Set1') +
labs(title  = bquote(bold('ICL Score: ')~ .(nrow(x)) ~' runs')) +
xlab('K') + ylab(bquote(italic('ICL'))) +
theme_light() +
facet_wrap(~tail, nrow = 1)
print(pa)
}
.plot.fit.summary(x)
library(dbpmm)
library(dbpmm)
library(dbpmm)
library(dbpmm)
load('1a4231de31794801d9b3911c79352830-allRuns.RData')
.plot.fit.summary(x)
load('3e767bee290c03b408abc737570a6d36-allRuns)
load('3e767bee290c03b408abc737570a6d36-allRuns')
x = res$tests
x = res$tests
.plot.fit.summary(x)
.plot.fit.summary(x[x$K > 1, ])
.plot.fit.summary(x[x$K >= 1, ])
.plot.fit.summary(x[x$K > 1, ])
.plot.fit.summary(x[x$K > 2, ])
.plot.fit.summary(x[x$K > 0
, ])
all(names(DP) %in% purity$samplename)
