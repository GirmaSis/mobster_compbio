cores.ratio = .8,
file.dump = NA,
seed = 12345,
top = 10,
annotation = NULL
)
DP.fit.params = list(
alpha_0 = 1e-4,
a1 = 1,
b1 = 1,
ngrid = 100,
nburn = 5000,
nsave = 10000,
nskip = 3,
ndisplay = 100,
state = NULL,
status = TRUE
)
vbdbmm.fit.params = list(
K = 5,
alpha_0 = 1e-8,
a_0 = 1,
b_0 = 1,
max_iter = NA,
epsilon_conv = 1e-10,
restarts = 10,
parallel = TRUE,
silent = TRUE
)
current.dir = getwd()
dir.create(output.folder)
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
if(output.folder != '.') dir.create(output.folder)
setwd(output.folder)
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
tail.fit = dbpmm.fit(
X = X,
K = dbpmm.fit.params$K,
samples = dbpmm.fit.params$samples,
init = dbpmm.fit.params$init,
tail = dbpmm.fit.params$tail,
epsilon = dbpmm.fit.params$epsilon,
maxIter = dbpmm.fit.params$maxIter,
is_verbose = dbpmm.fit.params$is_verbose,
fit.type = dbpmm.fit.params$fit.type,
parallel = dbpmm.fit.params$parallel,
cores.ratio = dbpmm.fit.params$cores.ratio,
file.dump = dbpmm.fit.params$file.dump,
seed = dbpmm.fit.params$seed,
top = dbpmm.fit.params$top,
annotation = dbpmm.fit.params$annotation
)
library(dbpmm)
library(dbpmm)
require(crayon)
tail.fit = dbpmm.fit(
X = X,
K = dbpmm.fit.params$K,
samples = dbpmm.fit.params$samples,
init = dbpmm.fit.params$init,
tail = dbpmm.fit.params$tail,
epsilon = dbpmm.fit.params$epsilon,
maxIter = dbpmm.fit.params$maxIter,
is_verbose = dbpmm.fit.params$is_verbose,
fit.type = dbpmm.fit.params$fit.type,
parallel = dbpmm.fit.params$parallel,
cores.ratio = dbpmm.fit.params$cores.ratio,
file.dump = dbpmm.fit.params$file.dump,
seed = dbpmm.fit.params$seed,
top = dbpmm.fit.params$top,
annotation = dbpmm.fit.params$annotation
)
c
..extract.DP.fit
c
`c`
c
tail.fit = dbpmm.fit(
X = X,
K = dbpmm.fit.params$K,
samples = dbpmm.fit.params$samples,
init = dbpmm.fit.params$init,
tail = dbpmm.fit.params$tail,
epsilon = dbpmm.fit.params$epsilon,
maxIter = dbpmm.fit.params$maxIter,
is_verbose = dbpmm.fit.params$is_verbose,
fit.type = dbpmm.fit.params$fit.type,
parallel = dbpmm.fit.params$parallel,
cores.ratio = dbpmm.fit.params$cores.ratio,
file.dump = dbpmm.fit.params$file.dump,
seed = dbpmm.fit.params$seed,
top = dbpmm.fit.params$top,
annotation = dbpmm.fit.params$annotation
)
X = x
X
tail.fit = dbpmm.fit(
X = X,
K = dbpmm.fit.params$K,
samples = dbpmm.fit.params$samples,
init = dbpmm.fit.params$init,
tail = dbpmm.fit.params$tail,
epsilon = dbpmm.fit.params$epsilon,
maxIter = dbpmm.fit.params$maxIter,
is_verbose = dbpmm.fit.params$is_verbose,
fit.type = dbpmm.fit.params$fit.type,
parallel = dbpmm.fit.params$parallel,
cores.ratio = dbpmm.fit.params$cores.ratio,
file.dump = dbpmm.fit.params$file.dump,
seed = dbpmm.fit.params$seed,
top = dbpmm.fit.params$top,
annotation = dbpmm.fit.params$annotation
)
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
tail.fit = dbpmm.fit(
X = X,
K = dbpmm.fit.params$K,
samples = dbpmm.fit.params$samples,
init = dbpmm.fit.params$init,
tail = dbpmm.fit.params$tail,
epsilon = dbpmm.fit.params$epsilon,
maxIter = dbpmm.fit.params$maxIter,
is_verbose = dbpmm.fit.params$is_verbose,
fit.type = dbpmm.fit.params$fit.type,
parallel = dbpmm.fit.params$parallel,
cores.ratio = dbpmm.fit.params$cores.ratio,
file.dump = dbpmm.fit.params$file.dump,
seed = dbpmm.fit.params$seed,
top = dbpmm.fit.params$top,
annotation = dbpmm.fit.params$annotation
)
source('~/Documents/GitHub/dbpmm/R/util.R')
source('~/Documents/GitHub/dbpmm/R/class.methods.R')
source('~/Documents/GitHub/dbpmm/R/plots.R')
tail.fit = dbpmm.fit(
X = X,
K = dbpmm.fit.params$K,
samples = dbpmm.fit.params$samples,
init = dbpmm.fit.params$init,
tail = dbpmm.fit.params$tail,
epsilon = dbpmm.fit.params$epsilon,
maxIter = dbpmm.fit.params$maxIter,
is_verbose = dbpmm.fit.params$is_verbose,
fit.type = dbpmm.fit.params$fit.type,
parallel = dbpmm.fit.params$parallel,
cores.ratio = dbpmm.fit.params$cores.ratio,
file.dump = dbpmm.fit.params$file.dump,
seed = dbpmm.fit.params$seed,
top = dbpmm.fit.params$top,
annotation = dbpmm.fit.params$annotation
)
source('~/Documents/GitHub/dbpmm/R/density.R')
tail.fit = dbpmm.fit(
X = X,
K = dbpmm.fit.params$K,
samples = dbpmm.fit.params$samples,
init = dbpmm.fit.params$init,
tail = dbpmm.fit.params$tail,
epsilon = dbpmm.fit.params$epsilon,
maxIter = dbpmm.fit.params$maxIter,
is_verbose = dbpmm.fit.params$is_verbose,
fit.type = dbpmm.fit.params$fit.type,
parallel = dbpmm.fit.params$parallel,
cores.ratio = dbpmm.fit.params$cores.ratio,
file.dump = dbpmm.fit.params$file.dump,
seed = dbpmm.fit.params$seed,
top = dbpmm.fit.params$top,
annotation = dbpmm.fit.params$annotation
)
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
dbpmm.fit.params = list(
K = 1:5,
samples = 10,
init = 'peaks',
tail = TRUE,
epsilon = 1e-10,
maxIter = 6000,
is_verbose = FALSE,
fit.type = 'MM',
parallel = TRUE,
cores.ratio = .8,
file.dump = NA,
seed = 12345,
top = 10,
annotation = NULL
)
tail.fit = dbpmm.fit(
X = X,
K = dbpmm.fit.params$K,
samples = dbpmm.fit.params$samples,
init = dbpmm.fit.params$init,
tail = dbpmm.fit.params$tail,
epsilon = dbpmm.fit.params$epsilon,
maxIter = dbpmm.fit.params$maxIter,
is_verbose = dbpmm.fit.params$is_verbose,
fit.type = dbpmm.fit.params$fit.type,
parallel = dbpmm.fit.params$parallel,
cores.ratio = dbpmm.fit.params$cores.ratio,
file.dump = dbpmm.fit.params$file.dump,
seed = dbpmm.fit.params$seed,
top = dbpmm.fit.params$top,
annotation = dbpmm.fit.params$annotation
)
dbpmm.fit.params = list(
K = 1:5,
samples = 10,
init = 'peaks',
tail = TRUE,
epsilon = 1e-10,
maxIter = 6000,
is_verbose = FALSE,
fit.type = 'MM',
parallel = F,
cores.ratio = .8,
file.dump = NA,
seed = 12345,
top = 10,
annotation = NULL
)
tail.fit = dbpmm.fit(
X = X,
K = dbpmm.fit.params$K,
samples = dbpmm.fit.params$samples,
init = dbpmm.fit.params$init,
tail = dbpmm.fit.params$tail,
epsilon = dbpmm.fit.params$epsilon,
maxIter = dbpmm.fit.params$maxIter,
is_verbose = dbpmm.fit.params$is_verbose,
fit.type = dbpmm.fit.params$fit.type,
parallel = dbpmm.fit.params$parallel,
cores.ratio = dbpmm.fit.params$cores.ratio,
file.dump = dbpmm.fit.params$file.dump,
seed = dbpmm.fit.params$seed,
top = dbpmm.fit.params$top,
annotation = dbpmm.fit.params$annotation
)
dbpmm.fit.params = list(
K = 1,
samples = 1,
init = 'peaks',
tail = TRUE,
epsilon = 1e-10,
maxIter = 6000,
is_verbose = FALSE,
fit.type = 'MM',
parallel = F,
cores.ratio = .8,
file.dump = NA,
seed = 12345,
top = 10,
annotation = NULL
)
tail.fit = dbpmm.fit(
X = X,
K = dbpmm.fit.params$K,
samples = dbpmm.fit.params$samples,
init = dbpmm.fit.params$init,
tail = dbpmm.fit.params$tail,
epsilon = dbpmm.fit.params$epsilon,
maxIter = dbpmm.fit.params$maxIter,
is_verbose = dbpmm.fit.params$is_verbose,
fit.type = dbpmm.fit.params$fit.type,
parallel = dbpmm.fit.params$parallel,
cores.ratio = dbpmm.fit.params$cores.ratio,
file.dump = dbpmm.fit.params$file.dump,
seed = dbpmm.fit.params$seed,
top = dbpmm.fit.params$top,
annotation = dbpmm.fit.params$annotation
)
# Best fit
best.fit = tail.fit[[1]]
best.fit
plot(ddbpmm)
plot(best.fit)
require(ggplot2)
plot(best.fit)
# remove tail mutations for the best fit, if the tail is used
if(all(is.na(best.fit$tail)))
{
cat(red('\n\n ===== Best dbpmm fit does not have a tail ===== \n\n'))
}
curX = length(X)
X = X[best.fit$labels != 'Tail']
save(X, file = paste(dbpmm.fit.params$file.dump, '-noTail.RData', sep = ''))
cat(green('\n\n ===== Best dbpmm fit with tail, removed',
(curX-length(X)),
'observations; reduction to',
round(length(X)/curX, 2),
'% ===== \n\n'))
cat(green('\n\n ===== Best dbpmm fit with tail, removed',
(curX-length(X)),
'observations; reduction to',
round(length(X)/curX, 2) * 100,
'% ===== \n\n'))
fit.vbdbmm = vbdbmm::vb_bmm1D_fit(
X = X,
K = vbdbmm.fit.params$K,
alpha_0 = vbdbmm.fit.params$alpha_0,
a_0 = vbdbmm.fit.params$a_0,
b_0 = vbdbmm.fit.params$b_0,
max_iter = vbdbmm.fit.params$max_iter,
epsilon_conv = vbdbmm.fit.params$epsilon_conv,
restarts = vbdbmm.fit.params$restarts,
parallel = vbdbmm.fit.params$parallel,
silent = vbdbmm.fit.params$silent
)
X
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
library(dbpmm)
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
devtools::document()
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
devtools::document()
library(dbpmm)
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
library(dbpmm)
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
library(dbpmm)
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
library(dbpmm)
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
library(dbpmm)
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
library(dbpmm)
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
library(dbpmm)
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
library(dbpmm)
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
library(dbpmm)
source('~/Documents/GitHub/dbpmm/R/util.R')
library(dbpmm)
source('~/Documents/GitHub/dbpmm/R/util.R')
source('~/Documents/GitHub/dbpmm/R/util.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/util.R')
source('~/Documents/GitHub/dbpmm/R/util.R')
source('~/Documents/GitHub/dbpmm/R/util.R')
source('~/Documents/GitHub/dbpmm/R/util.R')
library(dbpmm)
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
cat(bgBlue(
red('\n\n ===== Tail-detection via Dirichlet Beta-Pareto Mixtures ===== \n\n')))
cat(bgBlue(
white('\n\n ===== Tail-detection via Dirichlet Beta-Pareto Mixtures ===== \n\n')))
cat(bgBlue(white('\n\n ===== Tail-detection via Dirichlet Beta-Pareto Mixtures ===== \n\n')))
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
library(dbpmm)
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
tail.fit
# Best fit
best.fit = tail.fit[[1]]
best.fit
best.fit$tail
best.fit
best.fit[[1]]
best.fit[1]
best.fit
x = best.fit
x
x$labels
table(x$labels)
best
x
unlist(clus.size)
clus.size = table(x$labels)
unlist(clus.size)
names(clus.size)
clus.size[1]
clus.size[order(clus.size)]
clus.size[order(clus.size)]
x
library(dbpmm)
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
x
x$beta
best.fit$beta[c('a', 'b', 'mean'), ]
best.fit$beta[c('a', 'b', 'mean'), , drop = FALSE]
fits.tail.table = best.fit$beta[c('a', 'b', 'mean'), , drop = FALSE]
print(paste('TAIL: ', all(is.null(best.fit$tail))))
best.fit$tail
as.data.frame(fits.tail.table)
as.data.frame(best$tail)
as.data.frame(best.fit$tail)
data.frame(best.fit$tail)
data.frame(best.fit$tail, row.names = 'TAIL')
print(data.frame(best.fit$tail, row.names = 'TAIL'))
print(fits.tail.table)
print(fits.table)
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
rownames(fits.table) = second.fit
fits.table = Reduce(rbind, fits.table)
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
library(dbpmm)
fits.table
# else cat(paste(x$N.k, collapse = ', '), "\n")
print(clus.size)
paste(names(clus.size), clus.size)
paste(names(clus.size), clus.size, sep = '=')
paste(names(clus.size), clus.size, sep = ' = ', collapse = ', ')
library(dbpmm)
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
library(dbpmm)
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
print(data.frame(best.fit$tail, row.names = 'TAIL'))
print(data.frame(NULL, row.names = 'TAIL'))
!all(is.null(best.fit$tail))
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
library(dbpmm)
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
library(dbpmm)
devtools::document()
sessionInfo()
devtools::document()
DPpackage::DPbetabinom
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
devtools::document()
devtools::document()
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
library(dbpmm)
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
library(dbpmm)
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
library(dbpmm)
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
library(dbpmm)
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
library(dbpmm)
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
library(dbpmm)
??mle
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
library(dbpmm)
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
library(dbpmm)
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
library(dbpmm)
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
X= runif(100)
k=3
fit = NULL
fit$z_nk = matrix(runif(10000), ncol = 3)
fit$p
fit$pi = runif(3)
fit
fit$a=runif(3)
fit$b=runif(3)
MLE.fit = stats4::mle(
minuslogl = .NLLBetaMix(k, X, fit$z_nk, fit$pi),
start = list(a = fit$a[k-1], b = fit$b[k-1]))
MLE.fit = stats4::mle(
minuslogl = dbpmm:::.NLLBetaMix(k, X, fit$z_nk, fit$pi),
start = list(a = fit$a[k-1], b = fit$b[k-1]))
MLE.fit = stats4::mle(
minuslogl = function(a, b){return(-3)},
start = list(a = fit$a[k-1], b = fit$b[k-1]))
MLE.fit = stats4::mle(
minuslogl = function(a, b){return(a + b)},
start = list(a = fit$a[k-1], b = fit$b[k-1]))
MLE.fit
coef(MLE.fit)
coeff(MLE.fit)
Coeff(MLE.fit)
MLE.fit
names(MLE.fit)
class(MLE.fit)
stats4::coef(MLE.fit)
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
library(dbpmm)
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
library(dbpmm)
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
library(dbpmm)
source('~/Documents/GitHub/dbpmm/R/ML_fit_1D.R')
