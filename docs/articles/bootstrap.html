<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Confidence estimation via the bootstrap • mobster</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Confidence estimation via the bootstrap">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mobster</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/bootstrap.html">Confidence estimation via the bootstrap</a>
    </li>
    <li>
      <a href="../articles/evolutionary_analysis.html">Evolutionary analyses of mobster fits</a>
    </li>
    <li>
      <a href="../articles/introduction.html">Basic mobster usage: generating and fitting data</a>
    </li>
    <li>
      <a href="../articles/plotting.html">Plotting mobster fits</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Confidence estimation via the bootstrap</h1>
                        <h4 class="author">Giulio Caravagna</h4>
            
            <h4 class="date">September 2019</h4>
      
      
      <div class="hidden name"><code>bootstrap.Rmd</code></div>

    </div>

    
    
<p>This vignette describes how to compute the <em>bootstrap</em> confidence of a MOBSTER model.</p>
<p>The MOBSTER R package is available at <a href="https://github.com/caravagn/MOBSTER">Github</a>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(mobster)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="co">#&gt;  [ MOBSTER - Model-based clustering in cancer ] </span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co">#&gt; Author :  Giulio Caravagna &lt;gcaravagn@gmail.com&gt; </span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">#&gt; GitHub :  caravagn/mobster </span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt;  &gt;  [https://github.com/caravagn/mvMOBSTER] See package "mvmobster" for support with multi-region sequencing analyses.</span></a></code></pre></div>
<div id="bootstrapping-a-model" class="section level2">
<h2 class="hasAnchor">
<a href="#bootstrapping-a-model" class="anchor"></a>Bootstrapping a model</h2>
<p>There are two types of bootstrap functions available in MOBSTER: <em>parametric</em> and <em>nonparametric</em>.</p>
<ul>
<li>The former samples data from the model, and re-runs the fits;</li>
<li>the latter re-samples the data (with repetitions), and re-runs the fits.</li>
</ul>
<p>In both cases a distribution of the parameter fits can be approximated, and in the case of nonparametric bootstrap also the probability of clustering together two mutations can be computed.</p>
<p>To speed up the computation we show this with a smaller dataset.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># Data generation</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">dataset =<span class="st"> </span><span class="kw"><a href="../reference/random_dataset.html">random_dataset</a></span>(</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">  <span class="dt">N =</span> <span class="dv">400</span>, </a>
<a class="sourceLine" id="cb2-4" data-line-number="4">  <span class="dt">seed =</span> <span class="dv">123</span>, </a>
<a class="sourceLine" id="cb2-5" data-line-number="5">  <span class="dt">Beta_variance_scaling =</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6">  )</a>
<a class="sourceLine" id="cb2-7" data-line-number="7"></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co"># Fit model</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9">fit =<span class="st"> </span><span class="kw"><a href="../reference/mobster_fit.html">mobster_fit</a></span>(dataset<span class="op">$</span>data, <span class="dt">samples =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt;  [ MOBSTER fit ~ N = 400 ] </span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#&gt;  - Beta(s) K = 1,2,3 ~ Pareto tail : ON/OFF;</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co">#&gt;  - Fit by Moments-matching (s = 2000, i = peaks,  ε = 1e-10) scoring with reICL</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="co">#&gt;  - Runs 1 x 3 x 2 = 6 with parallel</span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co">#&gt;  - Clusters filter :  π &gt; 0.02  and  N &gt; 10 </span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-19" data-line-number="19"><span class="co">#&gt; MOBSTER fit completed in 0.24 mins </span></a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21"><span class="co">#&gt;  BEST FIT: reICL </span></a>
<a class="sourceLine" id="cb2-22" data-line-number="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-23" data-line-number="23"><span class="co">#&gt; [ MOBSTER ] N = 400 points with K = 2 Beta clusters, fit by MM in 132 steps [CONVERGED] </span></a>
<a class="sourceLine" id="cb2-24" data-line-number="24"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-25" data-line-number="25"><span class="co">#&gt;   Components (fit)  </span></a>
<a class="sourceLine" id="cb2-26" data-line-number="26"><span class="co">#&gt;      Tail    n = 107 (0.27)   Shape =   3 </span></a>
<a class="sourceLine" id="cb2-27" data-line-number="27"><span class="co">#&gt;   Beta C1    n = 115 (0.29)   Mean = 0.79</span></a>
<a class="sourceLine" id="cb2-28" data-line-number="28"><span class="co">#&gt;   Beta C2    n = 178 (0.44)   Mean = 0.45</span></a>
<a class="sourceLine" id="cb2-29" data-line-number="29"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-30" data-line-number="30"><span class="co">#&gt;   Scores (model selection)  </span></a>
<a class="sourceLine" id="cb2-31" data-line-number="31"><span class="co">#&gt;        NLL       BIC       AIC  entropy      ICL reduced.entropy     reICL</span></a>
<a class="sourceLine" id="cb2-32" data-line-number="32"><span class="co">#&gt;  -212.3238 -370.7243 -406.6475 25.51932 -345.205        20.06241 -350.6619</span></a>
<a class="sourceLine" id="cb2-33" data-line-number="33"><span class="co">#&gt;  size</span></a>
<a class="sourceLine" id="cb2-34" data-line-number="34"><span class="co">#&gt;     9</span></a>
<a class="sourceLine" id="cb2-35" data-line-number="35"></a>
<a class="sourceLine" id="cb2-36" data-line-number="36"><span class="co"># Composition with cowplot</span></a>
<a class="sourceLine" id="cb2-37" data-line-number="37">figure =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/cowplot/topics/plot_grid">plot_grid</a></span>(</a>
<a class="sourceLine" id="cb2-38" data-line-number="38">  dataset<span class="op">$</span>plot, </a>
<a class="sourceLine" id="cb2-39" data-line-number="39">  <span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(fit<span class="op">$</span>best), </a>
<a class="sourceLine" id="cb2-40" data-line-number="40">  <span class="dt">ncol =</span> <span class="dv">2</span>, </a>
<a class="sourceLine" id="cb2-41" data-line-number="41">  <span class="dt">align =</span> <span class="st">'h'</span>)</a>
<a class="sourceLine" id="cb2-42" data-line-number="42"></a>
<a class="sourceLine" id="cb2-43" data-line-number="43"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(figure)</a></code></pre></div>
<p><img src="bootstrap_files/figure-html/unnamed-chunk-3-1.png" width="768"></p>
<p>Now we are ready to compute <code>n.resamples</code> nonparametric bootstraps, and the bootstrapped statistics. We can do that using function <code>mobster_bootstrap</code> to which we can pass some parameters that will be forwarded to the calls of <code>mobster_fit</code></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># The returned object contains also the list of bootstrap resamples, and the fits.</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">bootstrap_results =<span class="st"> </span><span class="kw"><a href="../reference/mobster_bootstrap.html">mobster_bootstrap</a></span>(</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">  fit<span class="op">$</span>best,</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">  <span class="dt">bootstrap =</span> <span class="st">'nonparametric'</span>,</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">  <span class="dt">n.resamples =</span> <span class="dv">50</span>,</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">  <span class="dt">epsilon =</span> <span class="fl">1e-4</span>,   <span class="co"># forwarded to mobster_fit, optimization epsilon</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7">  <span class="dt">K =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">2</span>),      <span class="co"># forwarded to mobster_fit, test only models with 1 or 2 Betas</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8">  <span class="dt">cache =</span> <span class="ot">NULL</span>      <span class="co"># forwarded to mobster_fit, no cache</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9">  )</a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">#&gt;  [ MOBSTER bootstrap ~ 50 resamples from nonparametric bootstrap ] </span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">#&gt;  Bootstrapping for this MOBSTER model</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="co">#&gt; [ MOBSTER ] N = 400 points with K = 2 Beta clusters, fit by MM in 132 steps [CONVERGED] </span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="co">#&gt;   Components (fit)  </span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="co">#&gt;      Tail    n = 107 (0.27)   Shape =   3 </span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="co">#&gt;   Beta C1    n = 115 (0.29)   Mean = 0.79</span></a>
<a class="sourceLine" id="cb3-20" data-line-number="20"><span class="co">#&gt;   Beta C2    n = 178 (0.44)   Mean = 0.45</span></a>
<a class="sourceLine" id="cb3-21" data-line-number="21"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22"><span class="co">#&gt;   Scores (model selection)  </span></a>
<a class="sourceLine" id="cb3-23" data-line-number="23"><span class="co">#&gt;        NLL       BIC       AIC  entropy      ICL reduced.entropy     reICL</span></a>
<a class="sourceLine" id="cb3-24" data-line-number="24"><span class="co">#&gt;  -212.3238 -370.7243 -406.6475 25.51932 -345.205        20.06241 -350.6619</span></a>
<a class="sourceLine" id="cb3-25" data-line-number="25"><span class="co">#&gt;  size</span></a>
<a class="sourceLine" id="cb3-26" data-line-number="26"><span class="co">#&gt;     9</span></a>
<a class="sourceLine" id="cb3-27" data-line-number="27"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-28" data-line-number="28"><span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span></a>
<a class="sourceLine" id="cb3-29" data-line-number="29"><span class="co">#&gt;  Creating nonparametric bootstrap resamples</span></a>
<a class="sourceLine" id="cb3-30" data-line-number="30"><span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span></a>
<a class="sourceLine" id="cb3-31" data-line-number="31"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-32" data-line-number="32"><span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span></a>
<a class="sourceLine" id="cb3-33" data-line-number="33"><span class="co">#&gt;  Running fits (might take some time)</span></a>
<a class="sourceLine" id="cb3-34" data-line-number="34"><span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span></a></code></pre></div>
<p>The output object contains all the relevant information to analyze the results of this computation, which include the bootstrap resamples, the fits and possible errors.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># Resamples are available for inspection as list of lists, </span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co"># with a mapping to record the mutation id of the resample data.</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co"># Ids are row numbers.</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(bootstrap_results<span class="op">$</span>resamples[[<span class="dv">1</span>]][[<span class="dv">1</span>]] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as_tibble</span>())</a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt; # A tibble: 400 x 3</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt;       id    VAF original.id</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt;    &lt;int&gt;  &lt;dbl&gt;       &lt;int&gt;</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt;  1     1 0.179          142</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt;  2     2 0.812           51</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt;  3     3 0.415          208</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt;  4     4 0.515          218</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt;  5     5 0.473          220</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt;  6     6 0.558          152</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co">#&gt;  7     7 0.0736         314</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">#&gt;  8     8 0.901           93</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="co">#&gt;  9     9 0.779           75</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">#&gt; 10    10 0.0725         352</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="co">#&gt; # … with 390 more rows</span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"><span class="co"># Fits are available inside the $fits list</span></a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(bootstrap_results<span class="op">$</span>fits[[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb4-22" data-line-number="22"><span class="co">#&gt; [ MOBSTER ] N = 400 points with K = 2 Beta clusters, fit by MM in 41 steps [CONVERGED] </span></a>
<a class="sourceLine" id="cb4-23" data-line-number="23"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-24" data-line-number="24"><span class="co">#&gt;   Components (fit)  </span></a>
<a class="sourceLine" id="cb4-25" data-line-number="25"><span class="co">#&gt;      Tail    n = 103 (0.26)   Shape = 2.7 </span></a>
<a class="sourceLine" id="cb4-26" data-line-number="26"><span class="co">#&gt;   Beta C1    n = 121 (0.31)   Mean = 0.79</span></a>
<a class="sourceLine" id="cb4-27" data-line-number="27"><span class="co">#&gt;   Beta C2    n = 176 (0.43)   Mean = 0.45</span></a>
<a class="sourceLine" id="cb4-28" data-line-number="28"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-29" data-line-number="29"><span class="co">#&gt;   Scores (model selection)  </span></a>
<a class="sourceLine" id="cb4-30" data-line-number="30"><span class="co">#&gt;        NLL       BIC       AIC  entropy       ICL reduced.entropy</span></a>
<a class="sourceLine" id="cb4-31" data-line-number="31"><span class="co">#&gt;  -198.7224 -343.5217 -379.4449 24.20926 -319.3124        17.27039</span></a>
<a class="sourceLine" id="cb4-32" data-line-number="32"><span class="co">#&gt;      reICL size</span></a>
<a class="sourceLine" id="cb4-33" data-line-number="33"><span class="co">#&gt;  -326.2513    9</span></a>
<a class="sourceLine" id="cb4-34" data-line-number="34"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(bootstrap_results<span class="op">$</span>fits[[<span class="dv">1</span>]])</a></code></pre></div>
<p><img src="bootstrap_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co"># If any the computations raised an erorr, they will be stored </span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co"># inside %errors rather than $fits</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(bootstrap_results<span class="op">$</span>errors)</a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt; NULL</span></a></code></pre></div>
</div>
<div id="bootstrap-statistics" class="section level2">
<h2 class="hasAnchor">
<a href="#bootstrap-statistics" class="anchor"></a>Bootstrap statistics</h2>
<p>Bootstrap statistics can be computed with MOBSTER function <code>bootstrapped_statistics</code>.</p>
<p>The time to compute these stats depends on the number of mutations in the data, and the number of bootstrap resamples. In case of a <code>nonparmaetric</code> bootstrap <code>bootstrapped_statistics</code> computes also the data co-clustering probability, defined as the probability of any pair of mutations in the data to be clustered together across resamples. This statistics is the one that takes most time, as it its complexity scales as <code>N * N * B</code> with <code>N</code> mutations and <code>B</code> bootstrap resamples.</p>
<blockquote>
<p>Note that this probability depends on the joint resample probability of each pair of mutations, which is computable because samples are independent and uniform, and therefore each mutation is bootstrapped with probability 1/N.</p>
</blockquote>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># This function plots also to screen a bunch of statistics that are also returned</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">bootstrap_statistics =<span class="st"> </span><span class="kw"><a href="../reference/bootstrapped_statistics.html">bootstrapped_statistics</a></span>(</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">  fit<span class="op">$</span>best, </a>
<a class="sourceLine" id="cb6-4" data-line-number="4">  <span class="dt">bootstrap_results =</span> bootstrap_results</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">  )</a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt;  Bootstrap observations n = 50</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt;  Bootstrapped model frequency</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co">#&gt; # A tibble: 1 x 3</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co">#&gt;   Model           Frequency fit.model</span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="co">#&gt;   &lt;fct&gt;               &lt;dbl&gt; &lt;lgl&gt;    </span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17"><span class="co">#&gt; 1 K = 2 with tail         1 TRUE     </span></a>
<a class="sourceLine" id="cb6-18" data-line-number="18"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-19" data-line-number="19"><span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span></a>
<a class="sourceLine" id="cb6-20" data-line-number="20"><span class="co">#&gt;  CI (empirical quantiles from bootstrap replicates)</span></a>
<a class="sourceLine" id="cb6-21" data-line-number="21"><span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span></a>
<a class="sourceLine" id="cb6-22" data-line-number="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-23" data-line-number="23"><span class="co">#&gt; Mixing proportions </span></a>
<a class="sourceLine" id="cb6-24" data-line-number="24"><span class="co">#&gt;  # A tibble: 3 x 8</span></a>
<a class="sourceLine" id="cb6-25" data-line-number="25"><span class="co">#&gt;   cluster statistics   min lower_quantile higher_quantile   max fit.value</span></a>
<a class="sourceLine" id="cb6-26" data-line-number="26"><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt;          &lt;dbl&gt;           &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb6-27" data-line-number="27"><span class="co">#&gt; 1 C1      Mixing pr… 0.245          0.257           0.335 0.353     0.294</span></a>
<a class="sourceLine" id="cb6-28" data-line-number="28"><span class="co">#&gt; 2 C2      Mixing pr… 0.383          0.388           0.474 0.475     0.436</span></a>
<a class="sourceLine" id="cb6-29" data-line-number="29"><span class="co">#&gt; 3 Tail    Mixing pr… 0.218          0.222           0.315 0.336     0.270</span></a>
<a class="sourceLine" id="cb6-30" data-line-number="30"><span class="co">#&gt; # … with 1 more variable: init.value &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb6-31" data-line-number="31"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-32" data-line-number="32"><span class="co">#&gt; Tail shape/ scale </span></a>
<a class="sourceLine" id="cb6-33" data-line-number="33"><span class="co">#&gt;  # A tibble: 2 x 8</span></a>
<a class="sourceLine" id="cb6-34" data-line-number="34"><span class="co">#&gt;   cluster statistics    min lower_quantile higher_quantile    max fit.value</span></a>
<a class="sourceLine" id="cb6-35" data-line-number="35"><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;       &lt;dbl&gt;          &lt;dbl&gt;           &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb6-36" data-line-number="36"><span class="co">#&gt; 1 Tail    Scale      0.0500         0.0500          0.0504 0.0504    0.0500</span></a>
<a class="sourceLine" id="cb6-37" data-line-number="37"><span class="co">#&gt; 2 Tail    Shape      2.40           2.47            3.67   3.94      2.99  </span></a>
<a class="sourceLine" id="cb6-38" data-line-number="38"><span class="co">#&gt; # … with 1 more variable: init.value &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb6-39" data-line-number="39"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-40" data-line-number="40"><span class="co">#&gt; Beta peaks </span></a>
<a class="sourceLine" id="cb6-41" data-line-number="41"><span class="co">#&gt;  # A tibble: 4 x 8</span></a>
<a class="sourceLine" id="cb6-42" data-line-number="42"><span class="co">#&gt;   cluster statistics     min lower_quantile higher_quantile     max</span></a>
<a class="sourceLine" id="cb6-43" data-line-number="43"><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;        &lt;dbl&gt;          &lt;dbl&gt;           &lt;dbl&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb6-44" data-line-number="44"><span class="co">#&gt; 1 C1      Mean       0.774          0.776           0.808   0.815  </span></a>
<a class="sourceLine" id="cb6-45" data-line-number="45"><span class="co">#&gt; 2 C1      Variance   0.00446        0.00476         0.0111  0.0120 </span></a>
<a class="sourceLine" id="cb6-46" data-line-number="46"><span class="co">#&gt; 3 C2      Mean       0.430          0.436           0.461   0.467  </span></a>
<a class="sourceLine" id="cb6-47" data-line-number="47"><span class="co">#&gt; 4 C2      Variance   0.00512        0.00518         0.00735 0.00753</span></a>
<a class="sourceLine" id="cb6-48" data-line-number="48"><span class="co">#&gt; # … with 2 more variables: fit.value &lt;dbl&gt;, init.value &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb6-49" data-line-number="49"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-50" data-line-number="50"><span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span></a>
<a class="sourceLine" id="cb6-51" data-line-number="51"><span class="co">#&gt;  Bootstrapped co-clustering probability from nonparametric bootstrap</span></a>
<a class="sourceLine" id="cb6-52" data-line-number="52"><span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span></a>
<a class="sourceLine" id="cb6-53" data-line-number="53"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-54" data-line-number="54">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-55" data-line-number="55"><span class="st">  </span><span class="er">|</span><span class="st">                                                                 </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb6-56" data-line-number="56">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-57" data-line-number="57"><span class="st">  </span><span class="er">|=</span><span class="st">                                                                </span><span class="er">|</span><span class="st">   </span><span class="dv">2</span>%</a>
<a class="sourceLine" id="cb6-58" data-line-number="58">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-59" data-line-number="59"><span class="st">  </span><span class="er">|===</span><span class="st">                                                              </span><span class="er">|</span><span class="st">   </span><span class="dv">4</span>%</a>
<a class="sourceLine" id="cb6-60" data-line-number="60">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-61" data-line-number="61"><span class="st">  </span><span class="er">|====</span><span class="st">                                                             </span><span class="er">|</span><span class="st">   </span><span class="dv">6</span>%</a>
<a class="sourceLine" id="cb6-62" data-line-number="62">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-63" data-line-number="63"><span class="st">  </span><span class="er">|=====</span><span class="st">                                                            </span><span class="er">|</span><span class="st">   </span><span class="dv">8</span>%</a>
<a class="sourceLine" id="cb6-64" data-line-number="64">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-65" data-line-number="65"><span class="st">  </span><span class="er">|======</span><span class="st">                                                           </span><span class="er">|</span><span class="st">  </span><span class="dv">10</span>%</a>
<a class="sourceLine" id="cb6-66" data-line-number="66">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-67" data-line-number="67"><span class="st">  </span><span class="er">|========</span><span class="st">                                                         </span><span class="er">|</span><span class="st">  </span><span class="dv">12</span>%</a>
<a class="sourceLine" id="cb6-68" data-line-number="68">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-69" data-line-number="69"><span class="st">  </span><span class="er">|=========</span><span class="st">                                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">14</span>%</a>
<a class="sourceLine" id="cb6-70" data-line-number="70">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-71" data-line-number="71"><span class="st">  </span><span class="er">|==========</span><span class="st">                                                       </span><span class="er">|</span><span class="st">  </span><span class="dv">16</span>%</a>
<a class="sourceLine" id="cb6-72" data-line-number="72">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-73" data-line-number="73"><span class="st">  </span><span class="er">|============</span><span class="st">                                                     </span><span class="er">|</span><span class="st">  </span><span class="dv">18</span>%</a>
<a class="sourceLine" id="cb6-74" data-line-number="74">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-75" data-line-number="75"><span class="st">  </span><span class="er">|=============</span><span class="st">                                                    </span><span class="er">|</span><span class="st">  </span><span class="dv">20</span>%</a>
<a class="sourceLine" id="cb6-76" data-line-number="76">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-77" data-line-number="77"><span class="st">  </span><span class="er">|==============</span><span class="st">                                                   </span><span class="er">|</span><span class="st">  </span><span class="dv">22</span>%</a>
<a class="sourceLine" id="cb6-78" data-line-number="78">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-79" data-line-number="79"><span class="st">  </span><span class="er">|================</span><span class="st">                                                 </span><span class="er">|</span><span class="st">  </span><span class="dv">24</span>%</a>
<a class="sourceLine" id="cb6-80" data-line-number="80">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-81" data-line-number="81"><span class="st">  </span><span class="er">|=================</span><span class="st">                                                </span><span class="er">|</span><span class="st">  </span><span class="dv">26</span>%</a>
<a class="sourceLine" id="cb6-82" data-line-number="82">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-83" data-line-number="83"><span class="st">  </span><span class="er">|==================</span><span class="st">                                               </span><span class="er">|</span><span class="st">  </span><span class="dv">28</span>%</a>
<a class="sourceLine" id="cb6-84" data-line-number="84">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-85" data-line-number="85"><span class="st">  </span><span class="er">|====================</span><span class="st">                                             </span><span class="er">|</span><span class="st">  </span><span class="dv">30</span>%</a>
<a class="sourceLine" id="cb6-86" data-line-number="86">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-87" data-line-number="87"><span class="st">  </span><span class="er">|=====================</span><span class="st">                                            </span><span class="er">|</span><span class="st">  </span><span class="dv">32</span>%</a>
<a class="sourceLine" id="cb6-88" data-line-number="88">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-89" data-line-number="89"><span class="st">  </span><span class="er">|======================</span><span class="st">                                           </span><span class="er">|</span><span class="st">  </span><span class="dv">34</span>%</a>
<a class="sourceLine" id="cb6-90" data-line-number="90">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-91" data-line-number="91"><span class="st">  </span><span class="er">|=======================</span><span class="st">                                          </span><span class="er">|</span><span class="st">  </span><span class="dv">36</span>%</a>
<a class="sourceLine" id="cb6-92" data-line-number="92">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-93" data-line-number="93"><span class="st">  </span><span class="er">|=========================</span><span class="st">                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">38</span>%</a>
<a class="sourceLine" id="cb6-94" data-line-number="94">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-95" data-line-number="95"><span class="st">  </span><span class="er">|==========================</span><span class="st">                                       </span><span class="er">|</span><span class="st">  </span><span class="dv">40</span>%</a>
<a class="sourceLine" id="cb6-96" data-line-number="96">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-97" data-line-number="97"><span class="st">  </span><span class="er">|===========================</span><span class="st">                                      </span><span class="er">|</span><span class="st">  </span><span class="dv">42</span>%</a>
<a class="sourceLine" id="cb6-98" data-line-number="98">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-99" data-line-number="99"><span class="st">  </span><span class="er">|=============================</span><span class="st">                                    </span><span class="er">|</span><span class="st">  </span><span class="dv">44</span>%</a>
<a class="sourceLine" id="cb6-100" data-line-number="100">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-101" data-line-number="101"><span class="st">  </span><span class="er">|==============================</span><span class="st">                                   </span><span class="er">|</span><span class="st">  </span><span class="dv">46</span>%</a>
<a class="sourceLine" id="cb6-102" data-line-number="102">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-103" data-line-number="103"><span class="st">  </span><span class="er">|===============================</span><span class="st">                                  </span><span class="er">|</span><span class="st">  </span><span class="dv">48</span>%</a>
<a class="sourceLine" id="cb6-104" data-line-number="104">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-105" data-line-number="105"><span class="st">  </span><span class="er">|================================</span><span class="st">                                 </span><span class="er">|</span><span class="st">  </span><span class="dv">50</span>%</a>
<a class="sourceLine" id="cb6-106" data-line-number="106">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-107" data-line-number="107"><span class="st">  </span><span class="er">|==================================</span><span class="st">                               </span><span class="er">|</span><span class="st">  </span><span class="dv">52</span>%</a>
<a class="sourceLine" id="cb6-108" data-line-number="108">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-109" data-line-number="109"><span class="st">  </span><span class="er">|===================================</span><span class="st">                              </span><span class="er">|</span><span class="st">  </span><span class="dv">54</span>%</a>
<a class="sourceLine" id="cb6-110" data-line-number="110">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-111" data-line-number="111"><span class="st">  </span><span class="er">|====================================</span><span class="st">                             </span><span class="er">|</span><span class="st">  </span><span class="dv">56</span>%</a>
<a class="sourceLine" id="cb6-112" data-line-number="112">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-113" data-line-number="113"><span class="st">  </span><span class="er">|======================================</span><span class="st">                           </span><span class="er">|</span><span class="st">  </span><span class="dv">58</span>%</a>
<a class="sourceLine" id="cb6-114" data-line-number="114">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-115" data-line-number="115"><span class="st">  </span><span class="er">|=======================================</span><span class="st">                          </span><span class="er">|</span><span class="st">  </span><span class="dv">60</span>%</a>
<a class="sourceLine" id="cb6-116" data-line-number="116">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-117" data-line-number="117"><span class="st">  </span><span class="er">|========================================</span><span class="st">                         </span><span class="er">|</span><span class="st">  </span><span class="dv">62</span>%</a>
<a class="sourceLine" id="cb6-118" data-line-number="118">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-119" data-line-number="119"><span class="st">  </span><span class="er">|==========================================</span><span class="st">                       </span><span class="er">|</span><span class="st">  </span><span class="dv">64</span>%</a>
<a class="sourceLine" id="cb6-120" data-line-number="120">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-121" data-line-number="121"><span class="st">  </span><span class="er">|===========================================</span><span class="st">                      </span><span class="er">|</span><span class="st">  </span><span class="dv">66</span>%</a>
<a class="sourceLine" id="cb6-122" data-line-number="122">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-123" data-line-number="123"><span class="st">  </span><span class="er">|============================================</span><span class="st">                     </span><span class="er">|</span><span class="st">  </span><span class="dv">68</span>%</a>
<a class="sourceLine" id="cb6-124" data-line-number="124">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-125" data-line-number="125"><span class="st">  </span><span class="er">|==============================================</span><span class="st">                   </span><span class="er">|</span><span class="st">  </span><span class="dv">70</span>%</a>
<a class="sourceLine" id="cb6-126" data-line-number="126">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-127" data-line-number="127"><span class="st">  </span><span class="er">|===============================================</span><span class="st">                  </span><span class="er">|</span><span class="st">  </span><span class="dv">72</span>%</a>
<a class="sourceLine" id="cb6-128" data-line-number="128">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-129" data-line-number="129"><span class="st">  </span><span class="er">|================================================</span><span class="st">                 </span><span class="er">|</span><span class="st">  </span><span class="dv">74</span>%</a>
<a class="sourceLine" id="cb6-130" data-line-number="130">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-131" data-line-number="131"><span class="st">  </span><span class="er">|=================================================</span><span class="st">                </span><span class="er">|</span><span class="st">  </span><span class="dv">76</span>%</a>
<a class="sourceLine" id="cb6-132" data-line-number="132">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-133" data-line-number="133"><span class="st">  </span><span class="er">|===================================================</span><span class="st">              </span><span class="er">|</span><span class="st">  </span><span class="dv">78</span>%</a>
<a class="sourceLine" id="cb6-134" data-line-number="134">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-135" data-line-number="135"><span class="st">  </span><span class="er">|====================================================</span><span class="st">             </span><span class="er">|</span><span class="st">  </span><span class="dv">80</span>%</a>
<a class="sourceLine" id="cb6-136" data-line-number="136">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-137" data-line-number="137"><span class="st">  </span><span class="er">|=====================================================</span><span class="st">            </span><span class="er">|</span><span class="st">  </span><span class="dv">82</span>%</a>
<a class="sourceLine" id="cb6-138" data-line-number="138">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-139" data-line-number="139"><span class="st">  </span><span class="er">|=======================================================</span><span class="st">          </span><span class="er">|</span><span class="st">  </span><span class="dv">84</span>%</a>
<a class="sourceLine" id="cb6-140" data-line-number="140">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-141" data-line-number="141"><span class="st">  </span><span class="er">|========================================================</span><span class="st">         </span><span class="er">|</span><span class="st">  </span><span class="dv">86</span>%</a>
<a class="sourceLine" id="cb6-142" data-line-number="142">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-143" data-line-number="143"><span class="st">  </span><span class="er">|=========================================================</span><span class="st">        </span><span class="er">|</span><span class="st">  </span><span class="dv">88</span>%</a>
<a class="sourceLine" id="cb6-144" data-line-number="144">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-145" data-line-number="145"><span class="st">  </span><span class="er">|==========================================================</span><span class="st">       </span><span class="er">|</span><span class="st">  </span><span class="dv">90</span>%</a>
<a class="sourceLine" id="cb6-146" data-line-number="146">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-147" data-line-number="147"><span class="st">  </span><span class="er">|============================================================</span><span class="st">     </span><span class="er">|</span><span class="st">  </span><span class="dv">92</span>%</a>
<a class="sourceLine" id="cb6-148" data-line-number="148">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-149" data-line-number="149"><span class="st">  </span><span class="er">|=============================================================</span><span class="st">    </span><span class="er">|</span><span class="st">  </span><span class="dv">94</span>%</a>
<a class="sourceLine" id="cb6-150" data-line-number="150">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-151" data-line-number="151"><span class="st">  </span><span class="er">|==============================================================</span><span class="st">   </span><span class="er">|</span><span class="st">  </span><span class="dv">96</span>%</a>
<a class="sourceLine" id="cb6-152" data-line-number="152">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-153" data-line-number="153"><span class="st">  </span><span class="er">|================================================================</span><span class="st"> </span><span class="er">|</span><span class="st">  </span><span class="dv">98</span>%</a>
<a class="sourceLine" id="cb6-154" data-line-number="154">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb6-155" data-line-number="155"><span class="st">  </span><span class="er">|=================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a></code></pre></div>
<p>Object <code>bootstrap_statistics</code> contains several tibbles that aggregate the data, and for each one of them there is a MOBSTER function to plot the data.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># All bootstrapped values</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(bootstrap_statistics<span class="op">$</span>bootstrap_values)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">#&gt; # A tibble: 750 x 5</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt;    cluster statistics fit.value init.value resample</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;      &lt;dbl&gt;    &lt;int&gt;</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt;  1 Tail    Shape        2.70      4.50            1</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt;  2 Tail    Scale        0.0504    0.0504          1</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt;  3 Tail    Mean         0.0800    0.0648          1</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#&gt;  4 Tail    Variance     0.00338   0.000374        1</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt;  5 C2      a           18.6      31.1             1</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt;  6 C2      b           22.6      31.1             1</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">#&gt;  7 C2      Mean         0.451     0.302           1</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co">#&gt;  8 C2      Variance     0.00586   0.00202         1</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co">#&gt;  9 C1      a           19.4      22.8             1</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co">#&gt; 10 C1      b            5.27     22.8             1</span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="co">#&gt; # … with 740 more rows</span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"></a>
<a class="sourceLine" id="cb7-18" data-line-number="18"><span class="co"># The model probability</span></a>
<a class="sourceLine" id="cb7-19" data-line-number="19"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(bootstrap_statistics<span class="op">$</span>bootstrap_model)</a>
<a class="sourceLine" id="cb7-20" data-line-number="20"><span class="co">#&gt; # A tibble: 1 x 3</span></a>
<a class="sourceLine" id="cb7-21" data-line-number="21"><span class="co">#&gt;   Model           Frequency fit.model</span></a>
<a class="sourceLine" id="cb7-22" data-line-number="22"><span class="co">#&gt;   &lt;fct&gt;               &lt;dbl&gt; &lt;lgl&gt;    </span></a>
<a class="sourceLine" id="cb7-23" data-line-number="23"><span class="co">#&gt; 1 K = 2 with tail         1 TRUE</span></a>
<a class="sourceLine" id="cb7-24" data-line-number="24"></a>
<a class="sourceLine" id="cb7-25" data-line-number="25"><span class="co"># The parameter stastics</span></a>
<a class="sourceLine" id="cb7-26" data-line-number="26"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(bootstrap_statistics<span class="op">$</span>bootstrap_statistics)</a>
<a class="sourceLine" id="cb7-27" data-line-number="27"><span class="co">#&gt; # A tibble: 15 x 8</span></a>
<a class="sourceLine" id="cb7-28" data-line-number="28"><span class="co">#&gt;    cluster statistics     min lower_quantile higher_quantile     max</span></a>
<a class="sourceLine" id="cb7-29" data-line-number="29"><span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;        &lt;dbl&gt;          &lt;dbl&gt;           &lt;dbl&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb7-30" data-line-number="30"><span class="co">#&gt;  1 C1      a          1.04e+1      11.3             25.7     2.86e+1</span></a>
<a class="sourceLine" id="cb7-31" data-line-number="31"><span class="co">#&gt;  2 C1      b          2.93e+0       3.08             6.20    7.60e+0</span></a>
<a class="sourceLine" id="cb7-32" data-line-number="32"><span class="co">#&gt;  3 C1      Mean       7.74e-1       0.776            0.808   8.15e-1</span></a>
<a class="sourceLine" id="cb7-33" data-line-number="33"><span class="co">#&gt;  4 C1      Mixing pr… 2.45e-1       0.257            0.335   3.53e-1</span></a>
<a class="sourceLine" id="cb7-34" data-line-number="34"><span class="co">#&gt;  5 C1      Variance   4.46e-3       0.00476          0.0111  1.20e-2</span></a>
<a class="sourceLine" id="cb7-35" data-line-number="35"><span class="co">#&gt;  6 C2      a          1.45e+1      14.8             21.2     2.16e+1</span></a>
<a class="sourceLine" id="cb7-36" data-line-number="36"><span class="co">#&gt;  7 C2      b          1.74e+1      17.9             25.7     2.58e+1</span></a>
<a class="sourceLine" id="cb7-37" data-line-number="37"><span class="co">#&gt;  8 C2      Mean       4.30e-1       0.436            0.461   4.67e-1</span></a>
<a class="sourceLine" id="cb7-38" data-line-number="38"><span class="co">#&gt;  9 C2      Mixing pr… 3.83e-1       0.388            0.474   4.75e-1</span></a>
<a class="sourceLine" id="cb7-39" data-line-number="39"><span class="co">#&gt; 10 C2      Variance   5.12e-3       0.00518          0.00735 7.53e-3</span></a>
<a class="sourceLine" id="cb7-40" data-line-number="40"><span class="co">#&gt; 11 Tail    Mean       6.74e-2       0.0690           0.0842  8.62e-2</span></a>
<a class="sourceLine" id="cb7-41" data-line-number="41"><span class="co">#&gt; 12 Tail    Mixing pr… 2.18e-1       0.222            0.315   3.36e-1</span></a>
<a class="sourceLine" id="cb7-42" data-line-number="42"><span class="co">#&gt; 13 Tail    Scale      5.00e-2       0.0500           0.0504  5.04e-2</span></a>
<a class="sourceLine" id="cb7-43" data-line-number="43"><span class="co">#&gt; 14 Tail    Shape      2.40e+0       2.47             3.67    3.94e+0</span></a>
<a class="sourceLine" id="cb7-44" data-line-number="44"><span class="co">#&gt; 15 Tail    Variance   5.95e-4       0.000780         0.00619 7.73e-3</span></a>
<a class="sourceLine" id="cb7-45" data-line-number="45"><span class="co">#&gt; # … with 2 more variables: fit.value &lt;dbl&gt;, init.value &lt;dbl&gt;</span></a></code></pre></div>
<p>Bootstrapping, one can plot the model probability across re-samples as a barplot</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="../reference/plot_bootstrap_model_frequency.html">plot_bootstrap_model_frequency</a></span>(</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">  bootstrap_results, </a>
<a class="sourceLine" id="cb8-3" data-line-number="3">  bootstrap_statistics</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">  )</a></code></pre></div>
<p><img src="bootstrap_files/figure-html/unnamed-chunk-8-1.png" width="240"></p>
<p>Similarly, one can compute the parameter probabilities across re-samples, which we here aggregate as a figure.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># Plot the mixing proportions</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">mplot =<span class="st"> </span><span class="kw"><a href="../reference/plot_bootstrap_mixing_proportions.html">plot_bootstrap_mixing_proportions</a></span>(</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">  fit<span class="op">$</span>best, </a>
<a class="sourceLine" id="cb9-4" data-line-number="4">  <span class="dt">bootstrap_results =</span> bootstrap_results, </a>
<a class="sourceLine" id="cb9-5" data-line-number="5">  <span class="dt">bootstrap_statistics =</span> bootstrap_statistics</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">  )</a>
<a class="sourceLine" id="cb9-7" data-line-number="7"></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co"># Plot the tail parameters</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9">tplot =<span class="st"> </span><span class="kw"><a href="../reference/plot_bootstrap_tail.html">plot_bootstrap_tail</a></span>(</a>
<a class="sourceLine" id="cb9-10" data-line-number="10">  fit<span class="op">$</span>best, </a>
<a class="sourceLine" id="cb9-11" data-line-number="11">  <span class="dt">bootstrap_results =</span> bootstrap_results, </a>
<a class="sourceLine" id="cb9-12" data-line-number="12">  <span class="dt">bootstrap_statistics =</span> bootstrap_statistics</a>
<a class="sourceLine" id="cb9-13" data-line-number="13">  )</a>
<a class="sourceLine" id="cb9-14" data-line-number="14"></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="co"># Plot the Beta parameters</span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16">bplot =<span class="st"> </span><span class="kw"><a href="../reference/plot_bootstrap_Beta.html">plot_bootstrap_Beta</a></span>(</a>
<a class="sourceLine" id="cb9-17" data-line-number="17">  fit<span class="op">$</span>best, </a>
<a class="sourceLine" id="cb9-18" data-line-number="18">  <span class="dt">bootstrap_results =</span> bootstrap_results, </a>
<a class="sourceLine" id="cb9-19" data-line-number="19">  <span class="dt">bootstrap_statistics =</span> bootstrap_statistics</a>
<a class="sourceLine" id="cb9-20" data-line-number="20">  )</a>
<a class="sourceLine" id="cb9-21" data-line-number="21"><span class="co">#&gt; Warning: Removed 4 rows containing missing values (geom_bar).</span></a>
<a class="sourceLine" id="cb9-22" data-line-number="22"></a>
<a class="sourceLine" id="cb9-23" data-line-number="23"><span class="co">#&gt; Warning: Removed 4 rows containing missing values (geom_bar).</span></a>
<a class="sourceLine" id="cb9-24" data-line-number="24"></a>
<a class="sourceLine" id="cb9-25" data-line-number="25"><span class="co"># Figure</span></a>
<a class="sourceLine" id="cb9-26" data-line-number="26">figure =<span class="st"> </span><span class="kw">ggarrange</span>(</a>
<a class="sourceLine" id="cb9-27" data-line-number="27">  mplot,</a>
<a class="sourceLine" id="cb9-28" data-line-number="28">  tplot,</a>
<a class="sourceLine" id="cb9-29" data-line-number="29">  bplot,</a>
<a class="sourceLine" id="cb9-30" data-line-number="30">  <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">nrow =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb9-31" data-line-number="31">  <span class="dt">widths =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(.<span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb9-32" data-line-number="32">)</a>
<a class="sourceLine" id="cb9-33" data-line-number="33"></a>
<a class="sourceLine" id="cb9-34" data-line-number="34"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(figure)</a></code></pre></div>
<p><img src="bootstrap_files/figure-html/unnamed-chunk-9-1.png" width="1152"></p>
<p>Bcause this is a nonparametric bootstrap run, the co-clustering probability can be plot as well</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="kw"><a href="../reference/plot_bootstrap_coclustering.html">plot_bootstrap_coclustering</a></span>(</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">  fit<span class="op">$</span>best, </a>
<a class="sourceLine" id="cb10-4" data-line-number="4">  <span class="dt">bootstrap_results =</span> bootstrap_results, </a>
<a class="sourceLine" id="cb10-5" data-line-number="5">  <span class="dt">bootstrap_statistics =</span> bootstrap_statistics</a>
<a class="sourceLine" id="cb10-6" data-line-number="6">  )</a></code></pre></div>
<p><img src="bootstrap_files/figure-html/unnamed-chunk-10-1.png" width="537.6"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#bootstrapping-a-model">Bootstrapping a model</a></li>
      <li><a href="#bootstrap-statistics">Bootstrap statistics</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Giulio Caravagna.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
