<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Confidence estimation via the bootstrap • mobster</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Confidence estimation via the bootstrap">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mobster</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/mobster.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/bootstrap.html">Confidence estimation via the bootstrap</a>
    </li>
    <li>
      <a href="../articles/evolutionary_analysis.html">Evolutionary analyses of mobster fits</a>
    </li>
    <li>
      <a href="../articles/plotting.html">Plotting mobster fits</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Confidence estimation via the bootstrap</h1>
                        <h4 class="author">Giulio Caravagna</h4>
            
            <h4 class="date">September 2019</h4>
      
      
      <div class="hidden name"><code>bootstrap.Rmd</code></div>

    </div>

    
    
<p>This vignette describes how to compute the <em>bootstrap</em> confidence of a MOBSTER model.</p>
<p>The MOBSTER R package is available at <a href="https://github.com/caravagn/MOBSTER">Github</a>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(mobster)</a></code></pre></div>
<div id="bootstrapping-a-model" class="section level2">
<h2 class="hasAnchor">
<a href="#bootstrapping-a-model" class="anchor"></a>Bootstrapping a model</h2>
<p>There are two types of bootstrap functions available in MOBSTER: <em>parametric</em> and <em>nonparametric</em>.</p>
<ul>
<li>The former samples data from the model, and re-runs the fits;</li>
<li>the latter re-samples the data (with repetitions), and re-runs the fits.</li>
</ul>
<p>In both cases a distribution of the parameter fits can be approximated, and in the case of nonparametric bootstrap also the probability of clustering together two mutations can be computed.</p>
<p>To speed up the computation we show this with a smaller dataset.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># Data generation</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">dataset =<span class="st"> </span><span class="kw"><a href="../reference/random_dataset.html">random_dataset</a></span>(</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">  <span class="dt">N =</span> <span class="dv">400</span>, </a>
<a class="sourceLine" id="cb2-4" data-line-number="4">  <span class="dt">seed =</span> <span class="dv">123</span>, </a>
<a class="sourceLine" id="cb2-5" data-line-number="5">  <span class="dt">Beta_variance_scaling =</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6">  )</a>
<a class="sourceLine" id="cb2-7" data-line-number="7"></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co"># Fit model</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9">fit =<span class="st"> </span><span class="kw"><a href="../reference/mobster_fit.html">mobster_fit</a></span>(dataset<span class="op">$</span>data, <span class="dt">samples =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt;  [ MOBSTER fit ]</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co"># Composition with cowplot</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13">figure =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/cowplot/man/plot_grid.html">plot_grid</a></span>(</a>
<a class="sourceLine" id="cb2-14" data-line-number="14">  dataset<span class="op">$</span>plot, </a>
<a class="sourceLine" id="cb2-15" data-line-number="15">  <span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(fit<span class="op">$</span>best), </a>
<a class="sourceLine" id="cb2-16" data-line-number="16">  <span class="dt">ncol =</span> <span class="dv">2</span>, </a>
<a class="sourceLine" id="cb2-17" data-line-number="17">  <span class="dt">align =</span> <span class="st">'h'</span>)</a>
<a class="sourceLine" id="cb2-18" data-line-number="18"></a>
<a class="sourceLine" id="cb2-19" data-line-number="19"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(figure)</a></code></pre></div>
<p><img src="bootstrap_files/figure-html/unnamed-chunk-3-1.png" width="768"></p>
<p>Now we are ready to compute <code>n.resamples</code> nonparametric bootstraps, and the bootstrapped statistics. We can do that using function <code>mobster_bootstrap</code> to which we can pass some parameters that will be forwarded to the calls of <code>mobster_fit</code></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># The returned object contains also the list of bootstrap resamples, and the fits.</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">bootstrap_results =<span class="st"> </span><span class="kw"><a href="../reference/mobster_bootstrap.html">mobster_bootstrap</a></span>(</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">  fit<span class="op">$</span>best,</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">  <span class="dt">bootstrap =</span> <span class="st">'nonparametric'</span>,</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">  <span class="dt">n.resamples =</span> <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">  <span class="dt">epsilon =</span> <span class="fl">1e-4</span>,   <span class="co"># forwarded to mobster_fit, optimization epsilon</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7">  <span class="dt">K =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">2</span>),      <span class="co"># forwarded to mobster_fit, test only models with 1 or 2 Betas</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8">  <span class="dt">cache =</span> <span class="ot">NULL</span>      <span class="co"># forwarded to mobster_fit, no cache</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9">  )</a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">#&gt;  [ MOBSTER bootstrap ~ 3 resamples from nonparametric bootstrap ] </span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">#&gt;  Bootstrapping for this MOBSTER model</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="co">#&gt;  Creating nonparametric bootstrap resamples</span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-20" data-line-number="20"><span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span></a>
<a class="sourceLine" id="cb3-21" data-line-number="21"><span class="co">#&gt;  Running fits (might take some time)</span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22"><span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span></a></code></pre></div>
<p>The output object contains all the relevant information to analyze the results of this computation, which include the bootstrap resamples, the fits and possible errors.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># Resamples are available for inspection as list of lists, </span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co"># with a mapping to record the mutation id of the resample data.</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co"># Ids are row numbers.</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(bootstrap_results<span class="op">$</span>resamples[[<span class="dv">1</span>]][[<span class="dv">1</span>]] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as_tibble</span>())</a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt; # A tibble: 400 x 3</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt;       id    VAF original.id</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt;    &lt;int&gt;  &lt;dbl&gt;       &lt;int&gt;</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt;  1     1 0.757           55</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt;  2     2 0.413          145</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt;  3     3 0.787            3</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt;  4     4 0.850           18</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt;  5     5 0.524          135</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt;  6     6 0.272          351</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co">#&gt;  7     7 0.532          249</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">#&gt;  8     8 0.344          202</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="co">#&gt;  9     9 0.0981         396</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">#&gt; 10    10 0.0768         354</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="co">#&gt; # … with 390 more rows</span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"><span class="co"># Fits are available inside the $fits list</span></a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(bootstrap_results<span class="op">$</span>fits[[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb4-22" data-line-number="22"><span class="co">#&gt; ── [ MOBSTER ] My MOBSTER model n = 400, fit by MM in 28 steps (converged). ────────────────────────────────────────────</span></a>
<a class="sourceLine" id="cb4-23" data-line-number="23"><span class="co">#&gt; ● Tail [n = 61, 15%] with alpha = 2.2.</span></a>
<a class="sourceLine" id="cb4-24" data-line-number="24"><span class="co">#&gt; ● Beta C1 [n = 339, 85%] with mean = 0.57.</span></a>
<a class="sourceLine" id="cb4-25" data-line-number="25"><span class="co">#&gt; ℹ Score(s): NLL = -57.95; ICL = -45.75 (-79.95), H = 34.2 (0),</span></a>
<a class="sourceLine" id="cb4-26" data-line-number="26"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(bootstrap_results<span class="op">$</span>fits[[<span class="dv">1</span>]])</a></code></pre></div>
<p><img src="bootstrap_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co"># If any the computations raised an erorr, they will be stored </span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co"># inside %errors rather than $fits</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(bootstrap_results<span class="op">$</span>errors)</a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt; NULL</span></a></code></pre></div>
</div>
<div id="bootstrap-statistics" class="section level2">
<h2 class="hasAnchor">
<a href="#bootstrap-statistics" class="anchor"></a>Bootstrap statistics</h2>
<p>Bootstrap statistics can be computed with MOBSTER function <code>bootstrapped_statistics</code>.</p>
<p>The time to compute these stats depends on the number of mutations in the data, and the number of bootstrap resamples. In case of a <code>nonparmaetric</code> bootstrap <code>bootstrapped_statistics</code> computes also the data co-clustering probability, defined as the probability of any pair of mutations in the data to be clustered together across resamples. This statistics is the one that takes most time, as it its complexity scales as <code>N * N * B</code> with <code>N</code> mutations and <code>B</code> bootstrap resamples.</p>
<blockquote>
<p>Note that this probability depends on the joint resample probability of each pair of mutations, which is computable because samples are independent and uniform, and therefore each mutation is bootstrapped with probability 1/N.</p>
</blockquote>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># This function plots also to screen a bunch of statistics that are also returned</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">bootstrap_statistics =<span class="st"> </span><span class="kw"><a href="../reference/bootstrapped_statistics.html">bootstrapped_statistics</a></span>(</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">  fit<span class="op">$</span>best, </a>
<a class="sourceLine" id="cb6-4" data-line-number="4">  <span class="dt">bootstrap_results =</span> bootstrap_results</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">  )</a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt;  Bootstrap observations n = 3</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt;  Bootstrapped model frequency</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co">#&gt; # A tibble: 2 x 3</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co">#&gt;   Model           Frequency fit.model</span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="co">#&gt;   &lt;fct&gt;               &lt;dbl&gt; &lt;lgl&gt;    </span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17"><span class="co">#&gt; 1 K = 2 with tail     0.667 TRUE     </span></a>
<a class="sourceLine" id="cb6-18" data-line-number="18"><span class="co">#&gt; 2 K = 1 with tail     0.333 FALSE    </span></a>
<a class="sourceLine" id="cb6-19" data-line-number="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-20" data-line-number="20"><span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span></a>
<a class="sourceLine" id="cb6-21" data-line-number="21"><span class="co">#&gt;  CI (empirical quantiles from bootstrap replicates)</span></a>
<a class="sourceLine" id="cb6-22" data-line-number="22"><span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span></a>
<a class="sourceLine" id="cb6-23" data-line-number="23"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-24" data-line-number="24"><span class="co">#&gt; Mixing proportions </span></a>
<a class="sourceLine" id="cb6-25" data-line-number="25"><span class="co">#&gt;  # A tibble: 3 x 8</span></a>
<a class="sourceLine" id="cb6-26" data-line-number="26"><span class="co">#&gt;   cluster statistics   min lower_quantile higher_quantile   max fit.value</span></a>
<a class="sourceLine" id="cb6-27" data-line-number="27"><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt;          &lt;dbl&gt;           &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb6-28" data-line-number="28"><span class="co">#&gt; 1 C1      Mixing pr… 0.274          0.276           0.825 0.852     0.292</span></a>
<a class="sourceLine" id="cb6-29" data-line-number="29"><span class="co">#&gt; 2 C2      Mixing pr… 0.460          0.461           0.511 0.512     0.463</span></a>
<a class="sourceLine" id="cb6-30" data-line-number="30"><span class="co">#&gt; 3 Tail    Mixing pr… 0.148          0.152           0.226 0.227     0.245</span></a>
<a class="sourceLine" id="cb6-31" data-line-number="31"><span class="co">#&gt; # … with 1 more variable: init.value &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb6-32" data-line-number="32"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-33" data-line-number="33"><span class="co">#&gt; Tail shape/ scale </span></a>
<a class="sourceLine" id="cb6-34" data-line-number="34"><span class="co">#&gt;  # A tibble: 2 x 8</span></a>
<a class="sourceLine" id="cb6-35" data-line-number="35"><span class="co">#&gt;   cluster statistics    min lower_quantile higher_quantile    max fit.value</span></a>
<a class="sourceLine" id="cb6-36" data-line-number="36"><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;       &lt;dbl&gt;          &lt;dbl&gt;           &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb6-37" data-line-number="37"><span class="co">#&gt; 1 Tail    Scale      0.0508         0.0508          0.0513 0.0513    0.0500</span></a>
<a class="sourceLine" id="cb6-38" data-line-number="38"><span class="co">#&gt; 2 Tail    Shape      1.18           1.19            2.15   2.20      1.25  </span></a>
<a class="sourceLine" id="cb6-39" data-line-number="39"><span class="co">#&gt; # … with 1 more variable: init.value &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb6-40" data-line-number="40"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-41" data-line-number="41"><span class="co">#&gt; Beta peaks </span></a>
<a class="sourceLine" id="cb6-42" data-line-number="42"><span class="co">#&gt;  # A tibble: 4 x 8</span></a>
<a class="sourceLine" id="cb6-43" data-line-number="43"><span class="co">#&gt;   cluster statistics     min lower_quantile higher_quantile     max fit.value</span></a>
<a class="sourceLine" id="cb6-44" data-line-number="44"><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;        &lt;dbl&gt;          &lt;dbl&gt;           &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb6-45" data-line-number="45"><span class="co">#&gt; 1 C1      Mean       0.566          0.578           0.820   0.820     0.798  </span></a>
<a class="sourceLine" id="cb6-46" data-line-number="46"><span class="co">#&gt; 2 C1      Variance   0.00452        0.00453         0.0427  0.0447    0.00664</span></a>
<a class="sourceLine" id="cb6-47" data-line-number="47"><span class="co">#&gt; 3 C2      Mean       0.444          0.444           0.454   0.454     0.446  </span></a>
<a class="sourceLine" id="cb6-48" data-line-number="48"><span class="co">#&gt; 4 C2      Variance   0.00835        0.00837         0.00928 0.00930   0.00731</span></a>
<a class="sourceLine" id="cb6-49" data-line-number="49"><span class="co">#&gt; # … with 1 more variable: init.value &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb6-50" data-line-number="50"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-51" data-line-number="51"><span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span></a>
<a class="sourceLine" id="cb6-52" data-line-number="52"><span class="co">#&gt;  Bootstrapped co-clustering probability from nonparametric bootstrap</span></a>
<a class="sourceLine" id="cb6-53" data-line-number="53"><span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span></a>
<a class="sourceLine" id="cb6-54" data-line-number="54"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-55" data-line-number="55">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb6-56" data-line-number="56"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb6-57" data-line-number="57">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb6-58" data-line-number="58"><span class="st">  </span><span class="er">|=======================</span><span class="st">                                               </span><span class="er">|</span><span class="st">  </span><span class="dv">33</span>%</a>
<a class="sourceLine" id="cb6-59" data-line-number="59">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb6-60" data-line-number="60"><span class="st">  </span><span class="er">|===============================================</span><span class="st">                       </span><span class="er">|</span><span class="st">  </span><span class="dv">67</span>%</a>
<a class="sourceLine" id="cb6-61" data-line-number="61">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb6-62" data-line-number="62"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a></code></pre></div>
<p>Object <code>bootstrap_statistics</code> contains several tibbles that aggregate the data, and for each one of them there is a MOBSTER function to plot the data.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># All bootstrapped values</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(bootstrap_statistics<span class="op">$</span>bootstrap_values)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">#&gt; # A tibble: 40 x 5</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt;    cluster statistics        fit.value init.value resample</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;                 &lt;dbl&gt;      &lt;dbl&gt;    &lt;int&gt;</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt;  1 Tail    Shape                2.20      3.01           1</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt;  2 Tail    Scale                0.0508    0.0508         1</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt;  3 Tail    Mean                 0.0933    0.0761         1</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#&gt;  4 Tail    Variance             0.0202    0.00190        1</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt;  5 C1      a                    2.54     94.3            1</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt;  6 C1      b                    1.95     94.3            1</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">#&gt;  7 C1      Mean                 0.566     0.565          1</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co">#&gt;  8 C1      Variance             0.0447    0.00146        1</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co">#&gt;  9 Tail    Mixing proportion    0.148     0.5            1</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co">#&gt; 10 C1      Mixing proportion    0.852     0.5            1</span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="co">#&gt; # … with 30 more rows</span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"></a>
<a class="sourceLine" id="cb7-18" data-line-number="18"><span class="co"># The model probability</span></a>
<a class="sourceLine" id="cb7-19" data-line-number="19"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(bootstrap_statistics<span class="op">$</span>bootstrap_model)</a>
<a class="sourceLine" id="cb7-20" data-line-number="20"><span class="co">#&gt; # A tibble: 2 x 3</span></a>
<a class="sourceLine" id="cb7-21" data-line-number="21"><span class="co">#&gt;   Model           Frequency fit.model</span></a>
<a class="sourceLine" id="cb7-22" data-line-number="22"><span class="co">#&gt;   &lt;fct&gt;               &lt;dbl&gt; &lt;lgl&gt;    </span></a>
<a class="sourceLine" id="cb7-23" data-line-number="23"><span class="co">#&gt; 1 K = 2 with tail     0.667 TRUE     </span></a>
<a class="sourceLine" id="cb7-24" data-line-number="24"><span class="co">#&gt; 2 K = 1 with tail     0.333 FALSE</span></a>
<a class="sourceLine" id="cb7-25" data-line-number="25"></a>
<a class="sourceLine" id="cb7-26" data-line-number="26"><span class="co"># The parameter stastics</span></a>
<a class="sourceLine" id="cb7-27" data-line-number="27"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(bootstrap_statistics<span class="op">$</span>bootstrap_statistics)</a>
<a class="sourceLine" id="cb7-28" data-line-number="28"><span class="co">#&gt; # A tibble: 15 x 8</span></a>
<a class="sourceLine" id="cb7-29" data-line-number="29"><span class="co">#&gt;    cluster statistics     min lower_quantile higher_quantile       max fit.value</span></a>
<a class="sourceLine" id="cb7-30" data-line-number="30"><span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;        &lt;dbl&gt;          &lt;dbl&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb7-31" data-line-number="31"><span class="co">#&gt;  1 C1      a          2.54e+0        3.71           26.0      26.0      18.6    </span></a>
<a class="sourceLine" id="cb7-32" data-line-number="32"><span class="co">#&gt;  2 C1      b          1.95e+0        2.14            6.00      6.02      4.69   </span></a>
<a class="sourceLine" id="cb7-33" data-line-number="33"><span class="co">#&gt;  3 C1      Mean       5.66e-1        0.578           0.820     0.820     0.798  </span></a>
<a class="sourceLine" id="cb7-34" data-line-number="34"><span class="co">#&gt;  4 C1      Mixing pr… 2.74e-1        0.276           0.825     0.852     0.292  </span></a>
<a class="sourceLine" id="cb7-35" data-line-number="35"><span class="co">#&gt;  5 C1      Variance   4.52e-3        0.00453         0.0427    0.0447    0.00664</span></a>
<a class="sourceLine" id="cb7-36" data-line-number="36"><span class="co">#&gt;  6 C2      a          1.16e+1       11.7            12.7      12.7      14.6    </span></a>
<a class="sourceLine" id="cb7-37" data-line-number="37"><span class="co">#&gt;  7 C2      b          1.40e+1       14.0            15.8      15.9      18.2    </span></a>
<a class="sourceLine" id="cb7-38" data-line-number="38"><span class="co">#&gt;  8 C2      Mean       4.44e-1        0.444           0.454     0.454     0.446  </span></a>
<a class="sourceLine" id="cb7-39" data-line-number="39"><span class="co">#&gt;  9 C2      Mixing pr… 4.60e-1        0.461           0.511     0.512     0.463  </span></a>
<a class="sourceLine" id="cb7-40" data-line-number="40"><span class="co">#&gt; 10 C2      Variance   8.35e-3        0.00837         0.00928   0.00930   0.00731</span></a>
<a class="sourceLine" id="cb7-41" data-line-number="41"><span class="co">#&gt; 11 Tail    Mean       9.33e-2        0.0996          0.324     0.329     0.247  </span></a>
<a class="sourceLine" id="cb7-42" data-line-number="42"><span class="co">#&gt; 12 Tail    Mixing pr… 1.48e-1        0.152           0.226     0.227     0.245  </span></a>
<a class="sourceLine" id="cb7-43" data-line-number="43"><span class="co">#&gt; 13 Tail    Scale      5.08e-2        0.0508          0.0513    0.0513    0.0500 </span></a>
<a class="sourceLine" id="cb7-44" data-line-number="44"><span class="co">#&gt; 14 Tail    Shape      1.18e+0        1.19            2.15      2.20      1.25   </span></a>
<a class="sourceLine" id="cb7-45" data-line-number="45"><span class="co">#&gt; 15 Tail    Variance   2.02e-2      Inf             Inf       Inf       Inf      </span></a>
<a class="sourceLine" id="cb7-46" data-line-number="46"><span class="co">#&gt; # … with 1 more variable: init.value &lt;dbl&gt;</span></a></code></pre></div>
<p>Bootstrapping, one can plot the model probability across re-samples as a barplot</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="../reference/plot_bootstrap_model_frequency.html">plot_bootstrap_model_frequency</a></span>(</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">  bootstrap_results, </a>
<a class="sourceLine" id="cb8-3" data-line-number="3">  bootstrap_statistics</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">  )</a></code></pre></div>
<p><img src="bootstrap_files/figure-html/unnamed-chunk-8-1.png" width="240"></p>
<p>Similarly, one can compute the parameter probabilities across re-samples, which we here aggregate as a figure.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># Plot the mixing proportions</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">mplot =<span class="st"> </span><span class="kw"><a href="../reference/plot_bootstrap_mixing_proportions.html">plot_bootstrap_mixing_proportions</a></span>(</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">  fit<span class="op">$</span>best, </a>
<a class="sourceLine" id="cb9-4" data-line-number="4">  <span class="dt">bootstrap_results =</span> bootstrap_results, </a>
<a class="sourceLine" id="cb9-5" data-line-number="5">  <span class="dt">bootstrap_statistics =</span> bootstrap_statistics</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">  )</a>
<a class="sourceLine" id="cb9-7" data-line-number="7"></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co"># Plot the tail parameters</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9">tplot =<span class="st"> </span><span class="kw"><a href="../reference/plot_bootstrap_tail.html">plot_bootstrap_tail</a></span>(</a>
<a class="sourceLine" id="cb9-10" data-line-number="10">  fit<span class="op">$</span>best, </a>
<a class="sourceLine" id="cb9-11" data-line-number="11">  <span class="dt">bootstrap_results =</span> bootstrap_results, </a>
<a class="sourceLine" id="cb9-12" data-line-number="12">  <span class="dt">bootstrap_statistics =</span> bootstrap_statistics</a>
<a class="sourceLine" id="cb9-13" data-line-number="13">  )</a>
<a class="sourceLine" id="cb9-14" data-line-number="14"></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="co"># Plot the Beta parameters</span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16">bplot =<span class="st"> </span><span class="kw"><a href="../reference/plot_bootstrap_Beta.html">plot_bootstrap_Beta</a></span>(</a>
<a class="sourceLine" id="cb9-17" data-line-number="17">  fit<span class="op">$</span>best, </a>
<a class="sourceLine" id="cb9-18" data-line-number="18">  <span class="dt">bootstrap_results =</span> bootstrap_results, </a>
<a class="sourceLine" id="cb9-19" data-line-number="19">  <span class="dt">bootstrap_statistics =</span> bootstrap_statistics</a>
<a class="sourceLine" id="cb9-20" data-line-number="20">  )</a>
<a class="sourceLine" id="cb9-21" data-line-number="21"><span class="co">#&gt; Warning: Removed 4 rows containing missing values (geom_bar).</span></a>
<a class="sourceLine" id="cb9-22" data-line-number="22"></a>
<a class="sourceLine" id="cb9-23" data-line-number="23"><span class="co">#&gt; Warning: Removed 4 rows containing missing values (geom_bar).</span></a>
<a class="sourceLine" id="cb9-24" data-line-number="24"></a>
<a class="sourceLine" id="cb9-25" data-line-number="25"><span class="co"># Figure</span></a>
<a class="sourceLine" id="cb9-26" data-line-number="26">figure =<span class="st"> </span><span class="kw">ggarrange</span>(</a>
<a class="sourceLine" id="cb9-27" data-line-number="27">  mplot,</a>
<a class="sourceLine" id="cb9-28" data-line-number="28">  tplot,</a>
<a class="sourceLine" id="cb9-29" data-line-number="29">  bplot,</a>
<a class="sourceLine" id="cb9-30" data-line-number="30">  <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">nrow =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb9-31" data-line-number="31">  <span class="dt">widths =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb9-32" data-line-number="32">)</a>
<a class="sourceLine" id="cb9-33" data-line-number="33"></a>
<a class="sourceLine" id="cb9-34" data-line-number="34"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(figure)</a></code></pre></div>
<p><img src="bootstrap_files/figure-html/unnamed-chunk-9-1.png" width="1152"></p>
<p>Bcause this is a nonparametric bootstrap run, the co-clustering probability can be plot as well</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="kw"><a href="../reference/plot_bootstrap_coclustering.html">plot_bootstrap_coclustering</a></span>(</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">  fit<span class="op">$</span>best, </a>
<a class="sourceLine" id="cb10-4" data-line-number="4">  <span class="dt">bootstrap_results =</span> bootstrap_results, </a>
<a class="sourceLine" id="cb10-5" data-line-number="5">  <span class="dt">bootstrap_statistics =</span> bootstrap_statistics</a>
<a class="sourceLine" id="cb10-6" data-line-number="6">  )</a></code></pre></div>
<p><img src="bootstrap_files/figure-html/unnamed-chunk-10-1.png" width="537.6"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#bootstrapping-a-model">Bootstrapping a model</a></li>
      <li><a href="#bootstrap-statistics">Bootstrap statistics</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Giulio Caravagna.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
