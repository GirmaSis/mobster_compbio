<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Plotting mobster fits • mobster</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Plotting mobster fits">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mobster</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/mobster.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/bootstrap.html">Confidence estimation via the bootstrap</a>
    </li>
    <li>
      <a href="../articles/evolutionary_analysis.html">Evolutionary analyses of mobster fits</a>
    </li>
    <li>
      <a href="../articles/introduction.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/plotting.html">Plotting mobster fits</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Plotting mobster fits</h1>
                        <h4 class="author">Giulio Caravagna</h4>
            
            <h4 class="date">September 2019</h4>
      
      
      <div class="hidden name"><code>plotting.Rmd</code></div>

    </div>

    
    
<p>This vignette describes the plotting functions available in <a href="https://github.com/caravagn/MOBSTER">MOBSTER</a>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(mobster)</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># We load the fit available inside the package</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">'fit_example'</span>, <span class="dt">package =</span> <span class="st">'mobster'</span>)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co"># Print and plot the model</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(fit_example<span class="op">$</span>best)</a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt; ── [ MOBSTER ] My MOBSTER model n = 5000 with k = 2 Beta(s) and a tail ────────────────────────────────────────────────</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt; ● Clusters: π = 55% [C1], 31% [Tail] and 14% [C2], with π &gt; 0.</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt; ● Tail [n = 1370, 31%] with alpha = 1.2.</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt; ● Beta C1 [n = 2784, 55%] with mean = 0.48.</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt; ● Beta C2 [n = 846, 14%] with mean = 0.15.</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt; ℹ Score(s): NLL = -5671.5; ICL = -10359.09 (-11266.35), H = 907.26 (0). Fit converged by MM in 75 steps.</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(fit_example<span class="op">$</span>best)</a></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-3-1.png" width="480"></p>
<p>You can plot mutations annotated if the <code>x</code>% of probability mass in their maximum responsibility (<em>hard clustering</em>) is below a certain cutoff. Non-assigned mutations are</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="../reference/plot_latent_variables.html">plot_latent_variables</a></span>(fit_example<span class="op">$</span>best, <span class="dt">cutoff_assignment =</span> <span class="fl">.8</span>)</a></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-4-1.png" width="240"></p>
<p>You can plot the barplot of the mixing proportions, using the same colour scheme for the fit (here, default).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="../reference/plot_mixing_proportions.html">plot_mixing_proportions</a></span>(fit_example<span class="op">$</span>best)</a></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-5-1.png" width="288"></p>
<p>The negative log-likelihood of the fit can be plot against the iteration steps, so to check the the trend is decreasing.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="../reference/plot_NLL.html">plot_NLL</a></span>(fit_example<span class="op">$</span>best)</a></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-6-1.png" width="288"></p>
<p>A contributor to the NLL is the entropy of the mixture, which can be visualized along with the reduced entropy, which is used by reICL.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="../reference/plot_entropy.html">plot_entropy</a></span>(fit_example<span class="op">$</span>best)</a></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-7-1.png" width="288"></p>
<div id="selecting-alternative-best-models" class="section level3">
<h3 class="hasAnchor">
<a href="#selecting-alternative-best-models" class="anchor"></a>Selecting alternative best models<a name="alternative"></a>
</h3>
<p>Alternative models are returned function <code>mobster_fit</code>, and can be easly visualized.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span>(ggpubr)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co"># Figure assembly</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4">figure =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/ggpubr/man/ggarrange.html">ggarrange</a></span>(</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">  <span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(fit_example<span class="op">$</span>runs[[<span class="dv">1</span>]]),</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">  <span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(fit_example<span class="op">$</span>runs[[<span class="dv">2</span>]]),</a>
<a class="sourceLine" id="cb7-7" data-line-number="7">  <span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(fit_example<span class="op">$</span>runs[[<span class="dv">3</span>]]),</a>
<a class="sourceLine" id="cb7-8" data-line-number="8">  <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">nrow =</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9">)</a>
<a class="sourceLine" id="cb7-10" data-line-number="10"></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(figure)</a></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-8-1.png" width="1440"> The table reportin the scores can be visualised, and everal plots are available to inspect model selection.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(fit_example<span class="op">$</span>fits.table)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co">#&gt;         NLL        BIC        AIC   entropy        ICL reduced.entropy</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">#&gt; 5 -5671.504 -11266.353 -11325.008  907.2581 -10359.095    8.466073e-11</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">#&gt; 1 -5332.989 -10614.876 -10653.979  323.0130 -10291.863    0.000000e+00</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">#&gt; 2 -5332.968 -10589.280 -10647.935 2186.1915  -8403.089    1.903207e+03</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&gt; 4 -4442.905  -8834.707  -8873.810  544.0481  -8290.658    5.440481e+02</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#&gt; 3 -1570.709  -3115.867  -3135.419    0.0000  -3115.867    0.000000e+00</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&gt;        reICL size K  tail</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">#&gt; 5 -11266.353    9 2  TRUE</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">#&gt; 1 -10614.876    6 1  TRUE</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt; 2  -8686.073    9 2  TRUE</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&gt; 4  -8290.658    6 2 FALSE</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">#&gt; 3  -3115.867    3 1 FALSE</span></a></code></pre></div>
<p>One can plot of the sum of squared error (SSE) between the fit density and the data (binned with bins of size 0.01), for several solutions at once. This measure can represent a sort of goodness of fit statistics.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># Goodness of fit (SSE), for the top 3 fits.</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="kw"><a href="../reference/plot_gofit.html">plot_gofit</a></span>(fit_example, <span class="dt">TOP =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-10-1.png" width="576"></p>
<p>The scores can also be compared graphically. Running <code>plot_fit_scores</code> all the computed scoring functions (BIC, AIC, ICL and reICL) are shown, which helps understanding if the best model with the default score (reICL) is the best also according to the other scores. In this graphics the red dot represents the best model according to each score.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="../reference/plot_fit_scores.html">plot_fit_scores</a></span>(fit_example)</a></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-11-1.png" width="384"></p>
<p>These functions can be all wrapped by a call to <code>plot_model_selection</code> which plots the above summary statistics and the fits for each one of a set of top models (change the parameter <code>TOP</code> to select how many plots should be computed).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># Not run</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="kw"><a href="../reference/plot_model_selection.html">plot_model_selection</a></span>(fit_example, <span class="dt">TOP =</span> <span class="dv">5</span>)</a></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Giulio Caravagna.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
