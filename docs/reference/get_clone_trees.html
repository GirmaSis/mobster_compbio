<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Return clone trees from the fit. — get_clone_trees • mobster</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Return clone trees from the fit. — get_clone_trees" />
<meta property="og:description" content="This function uses the output fit of MOBSTER
to create a call to ctree (https://caravagn.github.io/ctree/),
a package to create clone trees for cancer evolution models.
Creation of a clone tree requires annotations that are not usually 
necessary for just a plain MOBSTER analyses. These annotations report the status of driver 
and gene for each one of the input datapoints, and should
be part of data given in input for MOBSTER (so they should be in x$data).
MOBSTER clusters are only used if the come from a Beta distribtutions; that is
the tail is removed. The clonal cluster is estimated from the cluster with the highest parameter
value for the Beta peak.
The output is the result of calling the constructor ctree::cetrees
on the input clustering results x." />
<meta property="og:image" content="caravagn.github.io/mobster/logo.png" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mobster</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/mobster.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/CloneTrees.html">Computing clone trees from mobster fits</a>
    </li>
    <li>
      <a href="../articles/Example_tumour_simulation.html">Visualizing subclonal expansions</a>
    </li>
    <li>
      <a href="../articles/bootstrap.html">Confidence estimation via the bootstrap</a>
    </li>
    <li>
      <a href="../articles/dnds.html">dN/dS statistics for mobster fits</a>
    </li>
    <li>
      <a href="../articles/introduction.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/plotting.html">Plotting mobster fits</a>
    </li>
    <li>
      <a href="../articles/popgen.html">Population Genetics statistics for mobster fits</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Return clone trees from the fit.</h1>
    
    <div class="hidden name"><code>get_clone_trees.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function uses the output fit of MOBSTER
to create a call to <code>ctree</code> (<a href='https://caravagn.github.io/ctree/'>https://caravagn.github.io/ctree/</a>),
a package to create clone trees for cancer evolution models.</p>
<p>Creation of a clone tree requires annotations that are not usually 
necessary for just a plain MOBSTER analyses. These annotations report the status of <code>driver</code> 
and <code>gene</code> for each one of the input datapoints, and should
be part of data given in input for MOBSTER (so they should be in <code>x$data</code>).</p>
<p>MOBSTER clusters are only used if the come from a Beta distribtutions; that is
the tail is removed. The clonal cluster is estimated from the cluster with the highest parameter
value for the Beta peak.</p>
<p>The output is the result of calling the constructor <code>ctree::cetrees</code>
on the input clustering results <code>x</code>.</p>
    </div>

    <pre class="usage"><span class='fu'>get_clone_trees</span>(<span class='no'>x</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A MOBSTER fit.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Extra parameters passed to the constructor <code>ctree::cetrees</code>, which
affect the sampling of the trees.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The output of the constructor <code>ctree::cetrees</code>.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># We take one of the released datasets</span>
<span class='no'>x</span> <span class='kw'>=</span> <span class='kw pkg'>mobster</span><span class='kw ns'>::</span><span class='no'><a href='https://rdrr.io/pkg/mobster/man/PD4120a_breast_sample.html'>PD4120a_breast_sample</a></span>$<span class='no'>best</span>

<span class='co'># Genes are already annotated</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>x</span>$<span class='no'>data</span>$<span class='no'>gene</span>)</div><div class='output co'>#&gt; [1] "LOC102723448(dist=8399),CHL1(dist=163705)" 
#&gt; [2] "LOC102723448(dist=14314),CHL1(dist=157790)"
#&gt; [3] "LOC102723448(dist=72916),CHL1(dist=99188)" 
#&gt; [4] "LOC102723448(dist=84382),CHL1(dist=87722)" 
#&gt; [5] "LOC102723448(dist=124685),CHL1(dist=47419)"
#&gt; [6] "LOC102723448(dist=132721),CHL1(dist=39383)"</div><div class='input'>
<span class='co'># Drivers we add, just taken at random from the exonic mutations.</span>
<span class='co'># Just print: x$data %&gt;% filter(region == 'exonic')</span>
<span class='co'># SETD2 could really be a driver.</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>require</a></span>(<span class='no'>dplyr</span>)
<span class='no'>genes_list</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>'ARHGAP31'</span>, <span class='st'>'ABCC5'</span>, <span class='st'>'SETD2'</span>)
<span class='no'>x</span>$<span class='no'>data</span> <span class='kw'>=</span> <span class='no'>x</span>$<span class='no'>data</span> <span class='kw'>%&gt;%</span>
  <span class='kw pkg'>dplyr</span><span class='kw ns'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span>(
    <span class='kw'>driver</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span>(<span class='no'>region</span> <span class='kw'>==</span> <span class='st'>'exonic'</span> <span class='kw'>&amp;</span> <span class='no'>gene</span> <span class='kw'>%in%</span> <span class='no'>genes_list</span>, <span class='fl'>TRUE</span>, <span class='fl'>FALSE</span>)
    )

<span class='co'># Get the trees</span>
<span class='no'>trees</span> <span class='kw'>=</span> <span class='fu'>get_clone_trees</span>(<span class='no'>x</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: replacing previous import ‘igraph::%s%’ by ‘matrixcalc::%s%’ when loading ‘ctree’</span></div><div class='output co'>#&gt; <span class='warning'>Warning: replacing previous import ‘igraph::groups’ by ‘tidygraph::groups’ when loading ‘ctree’</span></div><div class='output co'>#&gt; <span class='message'><span style='color: #00BB00;'>✓</span><span> Loading </span><span style='color: #00BB00;'>ctree</span><span>, </span><span style='font-style: italic;'>'Clone trees in cancer'</span><span>. Support : </span><span style='color: #0000BB;font-style: italic;'>&lt;https://caravagn.github.io/ctree/&gt;</span><span></span></div><div class='output co'>#&gt; </span><span style='color: #BBBBBB;background-color: #0000BB;'> [ ctree ~ generate clone trees for MOBSTER_dataset ] 
#&gt; </span><span style='color: #000000;background-color: #BBBB00;'>Sampler : </span><span> 10000 (cutoff),  5000 (sampling),  100 (max store) </span><span style='color: #000000;background-color: #BBBB00;'>
#&gt; </span><span style='color: #555555;'># A tibble: 3 x 5</span><span>
#&gt;   cluster    R1 nMuts is.clonal is.driver
#&gt;   </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>   </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;lgl&gt;</span><span>     </span><span style='color: #555555;font-style: italic;'>&lt;lgl&gt;</span><span>    
#&gt; </span><span style='color: #555555;'>1</span><span> C2      0.291  </span><span style='text-decoration: underline;'>1</span><span>167 FALSE     TRUE     
#&gt; </span><span style='color: #555555;'>2</span><span> C1      0.521  </span><span style='text-decoration: underline;'>1</span><span>740 TRUE      TRUE     
#&gt; </span><span style='color: #555555;'>3</span><span> C3      0.161   730 FALSE     TRUE     
#&gt; 
#&gt; </span><span style='color: #00BB00;background-color: #BBBB00;'>✔</span><span style='color: #000000;background-color: #BBBB00;'> Region</span><span> R1  ~  #CCF clusters &gt; 1%:  3 </span><span style='color: #000000;background-color: #BBBB00;'>
#&gt; </span><span style='color: #00BB00;background-color: #BBBB00;'>✔</span><span style='color: #000000;background-color: #BBBB00;'> Trees per region</span><span> 2 </span><span style='color: #000000;background-color: #BBBB00;'>
#&gt; </span><span style='color: #00BB00;background-color: #BBBB00;'>✔</span><span style='color: #000000;background-color: #BBBB00;'> Hashed trees</span><span> 2 </span><span style='color: #000000;background-color: #BBBB00;'>
#&gt; </span><span style='color: #00BB00;background-color: #BBBB00;'>✔</span><span style='color: #000000;background-color: #BBBB00;'> Structures</span><span> 2 - search is exahustive </span><span style='color: #000000;background-color: #BBBB00;'>
#&gt; </span><span style='color: #00BB00;background-color: #BBBB00;'>✔</span><span style='color: #000000;background-color: #BBBB00;'> Pigeonhole Principle</span><span>  </span><span style='color: #000000;background-color: #BBBB00;'>
#&gt; </span><span style='color: #00BB00;background-color: #BBBB00;'>✔</span><span style='color: #000000;background-color: #BBBB00;'> Ranking trees</span><span>  </span><span style='color: #000000;background-color: #BBBB00;'>
#&gt; </span><span style='color: #00BB00;background-color: #BBBB00;'>✔</span><span style='color: #000000;background-color: #BBBB00;'> Trees with non-zero sscore</span><span> 2 storing 2 </span><span style='color: #000000;background-color: #BBBB00;'>
#&gt; </span><span></div><div class='output co'>#&gt; <span class='message'>[easypar] 2020-03-30 19:22:50 - Overriding parallel execution setup [FALSE] with global option : FALSE</span></div><div class='input'>
<span class='co'># Print and plot the first tree (top rank)</span>
<span class='kw pkg'>ctree</span><span class='kw ns'>:::</span><span class='fu'><a href='https://rdrr.io/pkg/ctree/man/print.ctree.html'>print.ctree</a></span>(<span class='no'>trees</span><span class='kw'>[[</span><span class='fl'>1</span>]])</div><div class='output co'>#&gt; </span><span style='color: #BBBBBB;background-color: #0000BB;'> [ ctree - ctree rank 1/2 for MOBSTER_dataset ] 
#&gt; </span><span>
#&gt; </span><span style='color: #555555;'># A tibble: 3 x 5</span><span>
#&gt;   cluster    R1 nMuts is.clonal is.driver
#&gt;   </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>   </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;lgl&gt;</span><span>     </span><span style='color: #555555;font-style: italic;'>&lt;lgl&gt;</span><span>    
#&gt; </span><span style='color: #555555;'>1</span><span> C2      0.291  </span><span style='text-decoration: underline;'>1</span><span>167 FALSE     TRUE     
#&gt; </span><span style='color: #555555;'>2</span><span> C1      0.521  </span><span style='text-decoration: underline;'>1</span><span>740 TRUE      TRUE     
#&gt; </span><span style='color: #555555;'>3</span><span> C3      0.161   730 FALSE     TRUE     
#&gt; </span><span style='color: #000000;background-color: #BBBB00;'>
#&gt; Tree shape (drivers annotated)</span><span>  </span><span style='color: #000000;background-color: #BBBB00;'>
#&gt; 
#&gt; </span><span>  \-GL
#&gt;    \-C1 :: ARHGAP31, ARHGAP31
#&gt;     |-C3 :: SETD2
#&gt;     \-C2 :: ABCC5
#&gt; </span><span style='color: #000000;background-color: #BBBB00;'>
#&gt; Information transfer</span><span>  </span><span style='color: #000000;background-color: #BBBB00;'>
#&gt; 
#&gt; </span><span>   ARHGAP31 ---&gt; ABCC5 
#&gt;    ARHGAP31 ---&gt; ABCC5 
#&gt;    GL ---&gt; ARHGAP31 
#&gt;    GL ---&gt; ARHGAP31 
#&gt;    ARHGAP31 ---&gt; SETD2 
#&gt;    ARHGAP31 ---&gt; SETD2 
#&gt; </span><span style='color: #000000;background-color: #BBBB00;'>
#&gt; Tree score</span><span> 0.5 </span><span style='color: #000000;background-color: #BBBB00;'>
#&gt; </span><span></div><div class='input'><span class='kw pkg'>ctree</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/ctree/man/plot.ctree.html'>plot.ctree</a></span>(<span class='no'>trees</span><span class='kw'>[[</span><span class='fl'>1</span>]])</div><div class='output co'>#&gt; <span class='warning'>Warning: Duplicated aesthetics after name standardisation: na.rm</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Removed 1 rows containing missing values (geom_point).</span></div><div class='img'><img src='get_clone_trees-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='kw pkg'>ctree</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/ctree/man/plot_CCF_clusters.html'>plot_CCF_clusters</a></span>(<span class='no'>trees</span><span class='kw'>[[</span><span class='fl'>1</span>]])</div><div class='img'><img src='get_clone_trees-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='kw pkg'>ctree</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/ctree/man/plot_icon.html'>plot_icon</a></span>(<span class='no'>trees</span><span class='kw'>[[</span><span class='fl'>1</span>]])</div><div class='img'><img src='get_clone_trees-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='kw pkg'>ctree</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/ctree/man/plot_clone_size.html'>plot_clone_size</a></span>(<span class='no'>trees</span><span class='kw'>[[</span><span class='fl'>1</span>]])</div><div class='img'><img src='get_clone_trees-4.png' alt='' width='700' height='433' /></div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://sites.google.com/site/giuliocaravagna/'>Giulio Caravagna</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


